
# Description: Cash Sale - Processing workfow and journal entries configuration

CashSale6.typeId=1
CashSale6.form=csProcessing/view
CashSale6.edit=cash_sale_processing_edit
CashSale6.print=cashSalePDF/6/pdf
CashSale6.service=eulap.eb.service.CashSaleProcessingService
CashSale6.acct_transaction_types=1
CashSale6.oo.parent_to_child=1
CashSale6.oo.child_to_child=16
CashSale6.flow=1;2
CashSale6.1.statusId=1
CashSale6.1.required=
CashSale6.1.next=2
CashSale6.1.product_code=2009
CashSale6.1.module_code=8
CashSale6.2.statusId=7
CashSale6.2.required=1
CashSale6.2.next=0
CashSale6.2.product_code=2009
CashSale6.2.module_code=16
CashSale6.sql.entries=1;2;3;4;5;6;7;8;9
# Items - Cost Account - Debit
CashSale6.sql.1.je=SELECT 'CASH SALES - PROCESSING' as SOURCE, CS.CASH_SALE_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, \
	D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, CS.RECEIPT_DATE as GL_DATE, CONCAT('CS-P ', CS_NUMBER) as REFERENCE_NUMBER, \
	CS.SALE_INVOICE_NO AS DESCRIPTION, COALESCE(UNIT_COST, 0) * QUANTITY as DEBIT, 0 as CREDIT, FW.FORM_WORKFLOW_ID, \
	FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_ITEM CSI \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSI.CASH_SALE_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.COST_ACCOUNT AND AC.COMPANY_ID = CS.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CS.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CS.CASH_SALE_TYPE_ID = 6 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Items - Inventory Account - Credit
CashSale6.sql.2.je=SELECT 'CASH SALES - PROCESSING' as SOURCE, CS.CASH_SALE_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, \
	D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, CS.RECEIPT_DATE as GL_DATE, CONCAT('CS-P ', CS_NUMBER) as REFERENCE_NUMBER, \
	CS.SALE_INVOICE_NO AS DESCRIPTION, 0 as DEBIT, COALESCE(UNIT_COST, 0) * QUANTITY as CREDIT, FW.FORM_WORKFLOW_ID, \
	FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_ITEM CSI \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSI.CASH_SALE_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.INVENTORY_ACCOUNT AND AC.COMPANY_ID = CS.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CS.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CS.CASH_SALE_TYPE_ID = 6 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Items - Sales Account - Credit
CashSale6.sql.3.je=SELECT 'CASH SALES - PROCESSING' as SOURCE, CS.CASH_SALE_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, \
	D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, CS.RECEIPT_DATE as GL_DATE, CONCAT('CS-P ', CS_NUMBER) as REFERENCE_NUMBER, \
	CS.SALE_INVOICE_NO AS DESCRIPTION, 0 AS DEBIT, (QUANTITY * SRP) as CREDIT, FW.FORM_WORKFLOW_ID, \
	FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_ITEM CSI \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSI.CASH_SALE_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.SALES_ACCOUNT AND AC.COMPANY_ID = CS.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CS.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CS.CASH_SALE_TYPE_ID = 6 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Items - Sales Discount - Debit
CashSale6.sql.4.je=SELECT 'CASH SALES - PROCESSING' as SOURCE, CS.CASH_SALE_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, \
	D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, CS.RECEIPT_DATE as GL_DATE, CONCAT('CS-P ', CS_NUMBER) as REFERENCE_NUMBER, \
	CS.SALE_INVOICE_NO AS DESCRIPTION, COALESCE(DISCOUNT, 0) as DEBIT, 0 as CREDIT, FW.FORM_WORKFLOW_ID, \
	FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_ITEM CSI \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSI.CASH_SALE_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.SALES_DISCOUNT_ACCOUNT AND AC.COMPANY_ID = CS.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CS.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND DISCOUNT IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CS.CASH_SALE_TYPE_ID = 6 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Items - Inventory Account Settings (RM - Default Debit Account) - Debit
CashSale6.sql.5.je=SELECT 'CASH SALES - PROCESSING' as SOURCE, CS.CASH_SALE_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, \
	D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, CS.RECEIPT_DATE as GL_DATE, CONCAT('CS-P ', CS_NUMBER) as REFERENCE_NUMBER, \
	CS.SALE_INVOICE_NO AS DESCRIPTION, (QUANTITY * SRP) - COALESCE(DISCOUNT, 0) AS DEBIT, 0 as CREDIT, FW.FORM_WORKFLOW_ID, \
	FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_ITEM CSI \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSI.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CS.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CS.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CS.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CS.CASH_SALE_TYPE_ID = 6 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Items - Inventory Account Settings (RM - Bank Account) - Debit
CashSale6.sql.6.je=SELECT 'CASH SALES - PROCESSING' as SOURCE, CS.CASH_SALE_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, \
	D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, CS.RECEIPT_DATE as GL_DATE, CONCAT('CS-P ', CS_NUMBER) as REFERENCE_NUMBER, \
	CS.SALE_INVOICE_NO AS DESCRIPTION, (QUANTITY * SRP) - COALESCE(DISCOUNT, 0) AS DEBIT, 0 as CREDIT, FW.FORM_WORKFLOW_ID, \
	FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_ITEM CSI \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSI.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CS.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID = RM.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID AND AC.COMPANY_ID = CS.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CS.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CS.CASH_SALE_TYPE_ID = 6 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Other Charges - Inventory Account Settings (RM - Bank Account) - Debit
CashSale6.sql.7.je=SELECT 'CASH SALES - PROCESSING' as SOURCE, CS.CASH_SALE_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, \
	D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, CS.RECEIPT_DATE as GL_DATE, CONCAT('CS-P ', CS_NUMBER) as REFERENCE_NUMBER, \
	CS.SALE_INVOICE_NO AS DESCRIPTION, AL.AMOUNT AS DEBIT, 0 as CREDIT, FW.FORM_WORKFLOW_ID, \
	FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_AR_LINE AL \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = AL.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CS.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CS.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CS.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CS.CASH_SALE_TYPE_ID = 6 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
#Cash Sales - Other Charges - Negative Amount
CashSale6.sql.8.je=SELECT 'CASH SALES - PROCESSING' as SOURCE, CS.CASH_SALE_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, \
	D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, CS.RECEIPT_DATE as GL_DATE, \
	CONCAT('CS-P ', CS_NUMBER) as REFERENCE_NUMBER, CS.SALE_INVOICE_NO AS DESCRIPTION, ABS(AL.AMOUNT) AS DEBIT, 0 as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_AR_LINE AL \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = AL.CASH_SALE_ID \
	INNER JOIN AR_LINE_SETUP ALS ON ALS.AR_LINE_SETUP_ID = AL.AR_LINE_SETUP_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ALS.ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CS.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CS.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CS.CASH_SALE_TYPE_ID = 6 \
	AND AL.AMOUNT < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
#Cash Sales - Other Charges (Positive) -  Credit
CashSale6.sql.9.je=SELECT 'CASH SALES - PROCESSING' as SOURCE, CS.CASH_SALE_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, \
	D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, CS.RECEIPT_DATE as GL_DATE, \
	CONCAT('CS-P ', CS_NUMBER) as REFERENCE_NUMBER, CS.SALE_INVOICE_NO AS DESCRIPTION, 0 AS DEBIT, AL.AMOUNT as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_AR_LINE AL \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = AL.CASH_SALE_ID \
	INNER JOIN AR_LINE_SETUP ALS ON ALS.AR_LINE_SETUP_ID = AL.AR_LINE_SETUP_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ALS.ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CS.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CS.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CS.CASH_SALE_TYPE_ID = 6 \
	AND AL.AMOUNT >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
CashSale6.sql.je.jerr=AND CS.RECEIPT_DATE BETWEEN DATE_FROM AND DATE_TO \
	AND (CASE WHEN IN_REFERENCE_NUMBER NOT LIKE '-1' THEN CONCAT('CS-P ', CS.CS_NUMBER) LIKE IN_REFERENCE_NUMBER \
		ELSE IN_REFERENCE_NUMBER LIKE IN_REFERENCE_NUMBER END) \
	AND (CASE IN_SOURCE WHEN 'CASH SALES - PROCESSING' THEN CS.CASH_SALE_ID != 0 \
		WHEN 'ALL' THEN CS.CASH_SALE_ID != 0 \
		ELSE CS.CASH_SALE_ID = 0 END) \
	AND (CASE WHEN IN_IS_POSTED != -1 THEN FW.IS_COMPLETE = IN_IS_POSTED ELSE FW.IS_COMPLETE != IN_IS_POSTED END)
CashSale6.sql.je.ab=AND CS.RECEIPT_DATE <= IN_AS_OF_DATE \
	AND FW.IS_COMPLETE = 1
CashSale6.sql.je.aa=AND D.NUMBER BETWEEN IN_FROM_DIVISION AND IN_TO_DIVISION \
	AND AC.ACCOUNT_ID = IN_ACCOUNT_ID \
	AND CS.RECEIPT_DATE BETWEEN DATE_FROM AND DATE_TO \
	AND CS.SALE_INVOICE_NO LIKE IN_DESCRIPTION \
	AND FW.IS_COMPLETE = 1
CashSale6.sql.je.gll=AND AC.ACCOUNT_ID = IN_ACCOUNT_ID \
	AND CS.RECEIPT_DATE BETWEEN DATE_FROM AND DATE_TO \
	AND FW.IS_COMPLETE = 1
# Configuration for IS and BS by division
CashSale6.sql.1.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	COALESCE(UNIT_COST, 0) * QUANTITY as DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, CS.RECEIPT_DATEAS DATE \
	FROM CASH_SALE_ITEM CSI \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSI.CASH_SALE_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.COST_ACCOUNT AND AC.COMPANY_ID = CS.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CS.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CS.CASH_SALE_TYPE_ID = 6 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
CashSale6.sql.2.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 as DEBIT, COALESCE(UNIT_COST, 0) * QUANTITY as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, CS.RECEIPT_DATEAS DATE \
	FROM CASH_SALE_ITEM CSI \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSI.CASH_SALE_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.INVENTORY_ACCOUNT AND AC.COMPANY_ID = CS.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CS.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CS.CASH_SALE_TYPE_ID = 6 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
CashSale6.sql.3.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 AS DEBIT, QUANTITY * SRP as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, CS.RECEIPT_DATEAS DATE \
	FROM CASH_SALE_ITEM CSI \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSI.CASH_SALE_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.SALES_ACCOUNT AND AC.COMPANY_ID = CS.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CS.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CS.CASH_SALE_TYPE_ID = 6 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
CashSale6.sql.4.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	COALESCE(DISCOUNT, 0) as DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, CS.RECEIPT_DATEAS DATE \
	FROM CASH_SALE_ITEM CSI \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSI.CASH_SALE_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.SALES_DISCOUNT_ACCOUNT AND AC.COMPANY_ID = CS.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CS.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND DISCOUNT IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CS.CASH_SALE_TYPE_ID = 6 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
CashSale6.sql.5.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	CSI.AMOUNT AS DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, CS.RECEIPT_DATEAS DATE \
	FROM CASH_SALE_ITEM CSI \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSI.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CS.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CS.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CS.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CS.CASH_SALE_TYPE_ID = 6 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
CashSale6.sql.6.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	AMOUNT AS DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, CS.RECEIPT_DATEAS DATE \
	FROM CASH_SALE_ITEM CSI \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSI.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CS.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID = RM.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID AND AC.COMPANY_ID = CS.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CS.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CS.CASH_SALE_TYPE_ID = 6 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
CashSale6.sql.7.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	AL.AMOUNT AS DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, CS.RECEIPT_DATEAS DATE \
	FROM CASH_SALE_AR_LINE AL \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = AL.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CS.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CS.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CS.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CS.CASH_SALE_TYPE_ID = 6 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
CashSale6.sql.8.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	ABS(AL.AMOUNT) AS DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, CS.RECEIPT_DATEAS DATE \
	FROM CASH_SALE_AR_LINE AL \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = AL.CASH_SALE_ID \
	INNER JOIN AR_LINE_SETUP ALS ON ALS.AR_LINE_SETUP_ID = AL.AR_LINE_SETUP_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ALS.ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CS.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CS.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CS.CASH_SALE_TYPE_ID = 6 \
	AND AL.AMOUNT < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
CashSale6.sql.9.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 AS DEBIT, AL.AMOUNT as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, CS.RECEIPT_DATEAS DATE \
	FROM CASH_SALE_AR_LINE AL \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = AL.CASH_SALE_ID \
	INNER JOIN AR_LINE_SETUP ALS ON ALS.AR_LINE_SETUP_ID = AL.AR_LINE_SETUP_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ALS.ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CS.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CS.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CS.CASH_SALE_TYPE_ID = 6 \
	AND AL.AMOUNT >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
CashSale6.sql.bs=AND CS.RECEIPT_DATE <= IN_AS_OF_DATE \
	AND FW.IS_COMPLETE = 1
CashSale6.sql.is=AND CS.RECEIPT_DATE BETWEEN IN_DATE_FROM AND IN_DATE_TO \
	AND FW.IS_COMPLETE = 1
CashSale6.sql.inv.entries=1;2;3
CashSale6.sql.1.inv=SELECT 'CASH SALES - PROCESSING' AS SOURCE, CSI.WAREHOUSE_ID AS WAREHOUSE_ID, CSI.ITEM_ID AS ITEM_ID, \
	I.STOCK_CODE AS STOCK_CODE, I.DESCRIPTION AS DESCRIPTION, I.ITEM_CATEGORY_ID AS ITEM_CATEGORY_ID, \
	I.UNIT_MEASUREMENT_ID as UNIT_MEASUREMENT_ID, 0 AS IN_QUANTITY, CSI.QUANTITY AS OUT_QUANTITY, \
	0 AS IN_UNIT_COST, CSI.UNIT_COST AS OUT_UNIT_COST, 0 AS IN_TOTAL_COST, \
	(CSI.UNIT_COST * CSI.QUANTITY) AS OUT_TOTAL_COST, CS.RECEIPT_DATE AS DATE, CS.CREATED_DATE, \
	FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, I.ACTIVE, CONCAT('CS-P ', CS.CS_NUMBER) AS REFERENCE_NUMBER, \
	CS.SALE_INVOICE_NO AS INVOICE_NUMBER , C.NAME AS TRANS_DESCRIPTION, CSI.SRP AS SRP, \
	CS.EB_OBJECT_ID as PARENT_EB_OBJECT_ID, CSI.EB_OBJECT_ID as EB_OBJECT_ID \
	FROM CASH_SALE_ITEM CSI \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSI.CASH_SALE_ID \
	INNER JOIN FORM_WORKFLOW FW ON FW.FORM_WORKFLOW_ID = CS.FORM_WORKFLOW_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSI.ITEM_ID \
	INNER JOIN AR_CUSTOMER C ON C.AR_CUSTOMER_ID = CS.AR_CUSTOMER_ID \
	WHERE CS.CASH_SALE_TYPE_ID = 6 \
	AND CS.COMPANY_ID = IN_COMPANY_ID
CashSale6.sql.2.inv=SELECT 'CASH SALES - PROCESSING' AS SOURCE, CSI.WAREHOUSE_ID AS WAREHOUSE_ID, CSI.ITEM_ID AS ITEM_ID, \
	I.STOCK_CODE AS STOCK_CODE, I.DESCRIPTION AS DESCRIPTION, I.ITEM_CATEGORY_ID AS ITEM_CATEGORY_ID, \
	I.UNIT_MEASUREMENT_ID as UNIT_MEASUREMENT_ID, CSI.QUANTITY AS IN_QUANTITY, 0 AS OUT_QUANTITY, \
	0 AS IN_UNIT_COST, CSI.UNIT_COST AS OUT_UNIT_COST, 0 AS IN_TOTAL_COST, \
	(CSI.UNIT_COST * CSI.QUANTITY) AS OUT_TOTAL_COST, CS.RECEIPT_DATE AS DATE, CS.CREATED_DATE, \
	FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, I.ACTIVE, CONCAT('CS-P ', CS.CS_NUMBER) AS REFERENCE_NUMBER, \
	CS.SALE_INVOICE_NO AS INVOICE_NUMBER , C.NAME AS TRANS_DESCRIPTION, CSI.SRP AS SRP, \
	CS.EB_OBJECT_ID as PARENT_EB_OBJECT_ID, CSI.EB_OBJECT_ID as EB_OBJECT_ID \
	FROM CASH_SALE_ITEM CSI \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSI.CASH_SALE_ID \
	INNER JOIN FORM_WORKFLOW FW ON FW.FORM_WORKFLOW_ID = CS.FORM_WORKFLOW_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSI.ITEM_ID \
	INNER JOIN AR_CUSTOMER C ON C.AR_CUSTOMER_ID = CS.AR_CUSTOMER_ID \
	WHERE CS.CASH_SALE_TYPE_ID = 6 \
	AND CSI.CASH_SALE_ID IN (SELECT CSI_RM.CASH_SALE_ID FROM CSI_RAW_MATERIAL CSI_RM \
	INNER JOIN CASH_SALE CS1 ON CS1.CASH_SALE_ID = CSI_RM.CASH_SALE_ID \
	INNER JOIN FORM_WORKFLOW FW ON FW.FORM_WORKFLOW_ID = CS1.FORM_WORKFLOW_ID AND FW.CURRENT_STATUS_ID != 4 \
	WHERE CS1.CASH_SALE_TYPE_ID = 6 \
	AND CS1.RECEIPT_DATE = CS.RECEIPT_DATE) \
	AND CS.COMPANY_ID = IN_COMPANY_ID
CashSale6.sql.3.inv=SELECT 'CASH SALES - PROCESSING' AS SOURCE, CSI.WAREHOUSE_ID AS WAREHOUSE_ID, CSI.ITEM_ID AS ITEM_ID, \
	I.STOCK_CODE AS STOCK_CODE, I.DESCRIPTION AS DESCRIPTION, I.ITEM_CATEGORY_ID AS ITEM_CATEGORY_ID, \
	I.UNIT_MEASUREMENT_ID as UNIT_MEASUREMENT_ID, 0 AS IN_QUANTITY, CSI.QUANTITY AS OUT_QUANTITY, \
	0 AS IN_UNIT_COST, CSI.UNIT_COST AS OUT_UNIT_COST, 0 AS IN_TOTAL_COST, \
	(CSI.UNIT_COST * CSI.QUANTITY) AS OUT_TOTAL_COST, CS.RECEIPT_DATE AS DATE, CS.CREATED_DATE, \
	FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, I.ACTIVE, CONCAT('CS-P ', CS.CS_NUMBER) AS REFERENCE_NUMBER, \
	CS.SALE_INVOICE_NO AS INVOICE_NUMBER , C.NAME AS TRANS_DESCRIPTION, ISRP.SRP AS SRP, \
	CS.EB_OBJECT_ID as PARENT_EB_OBJECT_ID, CSI.EB_OBJECT_ID as EB_OBJECT_ID \
	FROM CSI_RAW_MATERIAL CSI \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSI.CASH_SALE_ID \
	INNER JOIN FORM_WORKFLOW FW ON FW.FORM_WORKFLOW_ID = CS.FORM_WORKFLOW_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSI.ITEM_ID \
	INNER JOIN ITEM_SRP ISRP ON ISRP.ITEM_ID = I.ITEM_ID AND ISRP.ACTIVE = 1 \
	INNER JOIN AR_CUSTOMER C ON C.AR_CUSTOMER_ID = CS.AR_CUSTOMER_ID \
	WHERE CS.CASH_SALE_TYPE_ID = 6 \
	AND CS.COMPANY_ID = IN_COMPANY_ID
CashSale6.sql.inv.as=AND FW.IS_COMPLETE = 1 \
	AND CSI.ITEM_ID = IN_ITEM_ID \
	AND CSI.WAREHOUSE_ID = IN_WAREHOUSE_ID \
	AND CS.RECEIPT_DATE <= IN_DATE
CashSale6.sql.inv.rsf=AND FW.IS_COMPLETE = 1 \
	AND CSI.ITEM_ID = IN_ITEM_ID \
	AND CSI.WAREHOUSE_ID = IN_WAREHOUSE_ID \
	AND CS.RECEIPT_DATE > IN_DATE
CashSale6.sql.inv.il=AND CS.RECEIPT_DATE <= IN_DATE \
	AND IF(IN_ITEM_CATEGORY_ID != -1, I.ITEM_CATEGORY_ID = IN_ITEM_CATEGORY_ID, I.ITEM_CATEGORY_ID != 0) \
	AND IF(IN_WAREHOUSE_ID != -1, CSI.WAREHOUSE_ID = IN_WAREHOUSE_ID, CSI.WAREHOUSE_ID != IN_WAREHOUSE_ID) \
	AND IF(IN_IS_ACTIVE != -1, I.ACTIVE = IN_IS_ACTIVE, I.ACTIVE != IN_IS_ACTIVE ) \
	AND CASE WHEN IN_STATUS = -1 THEN FW.CURRENT_STATUS_ID != 4 WHEN IN_STATUS = 1 THEN FW.IS_COMPLETE = 1 END
CashSale6.sql.inv.sc=AND FW.IS_COMPLETE = 1 \
	AND CSI.ITEM_ID = IN_ITEM_ID \
	AND CSI.WAREHOUSE_ID = IN_WAREHOUSE_ID \
	AND CS.RECEIPT_DATE BETWEEN IN_START_DATE AND IN_END_DATE
CashSale6.sql.inv.ft=AND FW.IS_COMPLETE = 1 \
	AND CSI.ITEM_ID = IN_ITEM_ID \
	AND CSI.WAREHOUSE_ID = IN_WAREHOUSE_ID \
	AND CS.RECEIPT_DATE > IN_AS_OF_DATE