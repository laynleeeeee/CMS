
#-- Description: AR Transaction - NSB 8 configuration

ArTransaction21.typeId=21
ArTransaction21.form=arTransactionForm/form/viewForm
ArTransaction21.edit=ar_transaction_nsb8_edit
ArTransaction21.print=arTransactionPrint/nsb/pdf
ArTransaction21.service=eulap.eb.service.ArTransactionService
ArTransaction21.oo.parent_to_child=1
ArTransaction21.acct_transaction_types=3
ArTransaction21.flow=1;2;3
ArTransaction21.1.statusId=1
ArTransaction21.1.required=
ArTransaction21.1.next=2
ArTransaction21.1.product_code=24063
ArTransaction21.1.module_code=8
ArTransaction21.2.statusId=30
ArTransaction21.2.required=1
ArTransaction21.2.next=3
ArTransaction21.2.product_code=24063
ArTransaction21.2.module_code=16
ArTransaction21.3.statusId=7
ArTransaction21.3.required=2
ArTransaction21.3.next=0
ArTransaction21.3.product_code=24063
ArTransaction21.3.module_code=32
ArTransaction21.sql.entries=1;2;3;4;5;6;7
# AR Transaction - Debit - Accounts Receivable
ArTransaction21.sql.1.je=SELECT 'AR TRANSACTION - NSB 8' as SOURCE, ART.AR_TRANSACTION_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, \
	A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, ART.GL_DATE, ART.TRANSACTION_NUMBER as REFERENCE_NUMBER, ART.DESCRIPTION, ART.AMOUNT AS DEBIT, 0 as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM AR_TRANSACTION ART \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = ART.CUSTOMER_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = ACA.DEFAULT_DEBIT_AC_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON ART.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ART.AMOUNT >= 0 \
	AND ART.TRANSACTION_CLASSIFICATION_ID IN (1, 2, 3) \
	AND ART.AR_TRANSACTION_TYPE_ID = 21 \
	AND ART.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# AR Transaction - Credit - Accounts Receivable
ArTransaction21.sql.2.je=SELECT 'AR TRANSACTION - NSB 8' as SOURCE, ART.AR_TRANSACTION_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, \
	A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, ART.GL_DATE, ART.TRANSACTION_NUMBER as REFERENCE_NUMBER, ART.DESCRIPTION, 0 AS DEBIT, -ART.AMOUNT as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM AR_TRANSACTION ART \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = ART.CUSTOMER_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = ACA.DEFAULT_DEBIT_AC_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON ART.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ART.AMOUNT < 0 \
	AND ART.TRANSACTION_CLASSIFICATION_ID IN (1, 2, 3) \
	AND ART.AR_TRANSACTION_TYPE_ID = 21 \
	AND ART.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# AR Line - Credit
ArTransaction21.sql.3.je=SELECT 'AR TRANSACTION - NSB 8' as SOURCE, ART.AR_TRANSACTION_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, \
	A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, ART.GL_DATE, ART.TRANSACTION_NUMBER as REFERENCE_NUMBER, ART.DESCRIPTION, 0 AS DEBIT, AL.AMOUNT as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM AR_SERVICE_LINE AL \
	INNER JOIN AR_TRANSACTION ART ON ART.AR_TRANSACTION_ID=AL.AR_TRANSACTION_ID \
	INNER JOIN SERVICE_SETTING ALS ON ALS.SERVICE_SETTING_ID = AL.SERVICE_SETTING_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = ALS.ACCOUNT_COMBINATION_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON ART.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE AL.AMOUNT >= 0 \
	AND ART.TRANSACTION_CLASSIFICATION_ID IN (1, 2, 3) \
	AND ART.AR_TRANSACTION_TYPE_ID = 21 \
	AND ART.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# AR Line - Debit
ArTransaction21.sql.4.je=SELECT 'AR TRANSACTION - NSB 8' as SOURCE, ART.AR_TRANSACTION_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, \
	A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, ART.GL_DATE, ART.TRANSACTION_NUMBER as REFERENCE_NUMBER, ART.DESCRIPTION, -AL.AMOUNT AS DEBIT, 0 as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM AR_SERVICE_LINE AL \
	INNER JOIN AR_TRANSACTION ART ON ART.AR_TRANSACTION_ID=AL.AR_TRANSACTION_ID \
	INNER JOIN SERVICE_SETTING ALS ON ALS.SERVICE_SETTING_ID = AL.SERVICE_SETTING_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = ALS.ACCOUNT_COMBINATION_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON ART.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE AL.AMOUNT < 0 \
	AND ART.TRANSACTION_CLASSIFICATION_ID IN (1, 2, 3) \
	AND ART.AR_TRANSACTION_TYPE_ID = 21 \
	AND ART.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Withholding Tax
ArTransaction21.sql.5.je=SELECT 'AR TRANSACTION - NSB 8' as SOURCE, ART.AR_TRANSACTION_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, \
	D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, ART.GL_DATE, ART.TRANSACTION_NUMBER as REFERENCE_NUMBER, \
	ART.DESCRIPTION, IF(ART.AMOUNT > 0, ART.WT_AMOUNT, 0) AS DEBIT, IF(ART.AMOUNT < 0, ABS(ART.WT_AMOUNT), 0) as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM AR_TRANSACTION ART \
	INNER JOIN WT_ACCOUNT_SETTING WTAS ON WTAS.WT_ACCOUNT_SETTING_ID = ART.WT_ACCOUNT_SETTING_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = WTAS.ACCOUNT_COMBINATION_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON ART.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ART.TRANSACTION_CLASSIFICATION_ID IN (1, 2, 3) \
	AND ART.AR_TRANSACTION_TYPE_ID = 21 \
	AND ART.WT_ACCOUNT_SETTING_ID IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND ART.COMPANY_ID = AC.COMPANY_ID \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# VAT
ArTransaction21.sql.6.je=SELECT 'AR TRANSACTION - NSB 8' as SOURCE, ART.AR_TRANSACTION_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, \
	D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, ART.GL_DATE, ART.TRANSACTION_NUMBER as REFERENCE_NUMBER, \
	ART.DESCRIPTION, IF(AL.AMOUNT < 0, ABS(AL.VAT_AMOUNT), 0) AS DEBIT, IF(ART.AMOUNT > 0, AL.VAT_AMOUNT, 0) as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM AR_SERVICE_LINE AL \
	INNER JOIN AR_TRANSACTION ART ON ART.AR_TRANSACTION_ID = AL.AR_TRANSACTION_ID \
	INNER JOIN VAT_ACCOUNT_SETUP VAS ON IF(ART.DIVISION_ID IS NOT NULL, \
	(VAS.COMPANY_ID = ART.COMPANY_ID AND VAS.DIVISION_ID = ART.DIVISION_ID), VAS.COMPANY_ID = ART.COMPANY_ID) \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = VAS.OUTPUT_VAT_AC_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON ART.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ART.TRANSACTION_CLASSIFICATION_ID IN (1, 2, 3) \
	AND ART.AR_TRANSACTION_TYPE_ID = 21 \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND VAS.TAX_TYPE_ID = AL.TAX_TYPE_ID \
	AND AL.TAX_TYPE_ID IN (1, 8, 9) \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Withholding VAT
ArTransaction21.sql.7.je=SELECT 'AR TRANSACTION - NSB 8' as SOURCE, ART.AR_TRANSACTION_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, \
	D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, ART.GL_DATE, ART.TRANSACTION_NUMBER as REFERENCE_NUMBER, \
	ART.DESCRIPTION, IF(ART.AMOUNT > 0, ART.WT_VAT_AMOUNT, 0) AS DEBIT, IF(ART.AMOUNT < 0, ABS(ART.WT_VAT_AMOUNT), 0) as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM AR_TRANSACTION ART \
	INNER JOIN AR_INVOICE_ACCOUNT ARIA ON (ARIA.COMPANY_ID = ART.COMPANY_ID AND ARIA.DIVISION_ID = ART.DIVISION_ID) \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = ARIA.WT_VAT_SERVICE_AC_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON ART.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ART.TRANSACTION_CLASSIFICATION_ID IN (1, 2, 3) \
	AND ART.AR_TRANSACTION_TYPE_ID = 21 \
	AND ART.WT_VAT_AMOUNT != 0 \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND ART.COMPANY_ID = IN_COMPANY_ID
ArTransaction21.sql.je.jerr=AND ART.GL_DATE BETWEEN DATE_FROM and DATE_TO \
	AND (CASE WHEN IN_REFERENCE_NUMBER NOT LIKE '-1' THEN ART.TRANSACTION_NUMBER like IN_REFERENCE_NUMBER \
		ELSE IN_REFERENCE_NUMBER like IN_REFERENCE_NUMBER END) \
	AND (CASE IN_SOURCE WHEN 'AR TRANSACTION - NSB 8' THEN ART.AR_TRANSACTION_ID != 0 \
		WHEN 'ALL' THEN ART.AR_TRANSACTION_ID != 0 \
		ELSE ART.AR_TRANSACTION_ID = 0 END) \
	AND (CASE WHEN IN_IS_POSTED != -1 THEN FW.IS_COMPLETE = IN_IS_POSTED ELSE FW.IS_COMPLETE != IN_IS_POSTED END)
ArTransaction21.sql.je.ab=AND IF(DATE_FROM IS NOT NULL, ART.GL_DATE BETWEEN DATE_FROM AND DATE_TO, ART.GL_DATE <= DATE_TO) \
	AND IF(IN_DIVISION_ID != -1, ART.DIVISION_ID = IN_DIVISION_ID, ART.DIVISION_ID != IN_DIVISION_ID) \
	AND FW.IS_COMPLETE = 1
ArTransaction21.sql.je.aa=AND D.NUMBER BETWEEN IN_FROM_DIVISION AND IN_TO_DIVISION \
	AND AC.ACCOUNT_ID = IN_ACCOUNT_ID \
	AND ART.GL_DATE BETWEEN DATE_FROM AND DATE_TO \
	AND ART.DESCRIPTION LIKE IN_DESCRIPTION \
	AND FW.IS_COMPLETE = 1
ArTransaction21.sql.je.gll=AND AC.ACCOUNT_ID = IN_ACCOUNT_ID \
	AND ART.GL_DATE BETWEEN DATE_FROM AND DATE_TO \
	AND FW.IS_COMPLETE = 1
# Configuration for IS and BS by division
# AR Transaction - Debit - Accounts Receivable
ArTransaction21.sql.1.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	ART.AMOUNT AS DEBIT, 0 as CREDIT, A.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, ART.TRANSACTION_DATE AS DATE \
	FROM AR_TRANSACTION ART \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = ART.CUSTOMER_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = ACA.DEFAULT_DEBIT_AC_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON ART.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ART.AMOUNT > 0 \
	AND ART.TRANSACTION_CLASSIFICATION_ID IN (1, 2, 3) \
	AND ART.AR_TRANSACTION_TYPE_ID = 21 \
	AND ART.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# AR Transaction - Credit - Accounts Receivable
ArTransaction21.sql.2.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 AS DEBIT, -ART.AMOUNT as CREDIT, A.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, ART.TRANSACTION_DATE AS DATE \
	FROM AR_TRANSACTION ART \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = ART.CUSTOMER_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = ACA.DEFAULT_DEBIT_AC_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON ART.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ART.AMOUNT < 0 \
	AND ART.TRANSACTION_CLASSIFICATION_ID IN (1, 2, 3) \
	AND ART.AR_TRANSACTION_TYPE_ID = 21 \
	AND ART.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# AR Line - Credit
ArTransaction21.sql.3.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 AS DEBIT, AL.AMOUNT as CREDIT, A.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, ART.TRANSACTION_DATE AS DATE \
	FROM AR_SERVICE_LINE AL \
	INNER JOIN AR_TRANSACTION ART ON ART.AR_TRANSACTION_ID=AL.AR_TRANSACTION_ID \
	INNER JOIN SERVICE_SETTING ALS ON ALS.SERVICE_SETTING_ID = AL.SERVICE_SETTING_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = ALS.ACCOUNT_COMBINATION_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON ART.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE AL.AMOUNT >= 0 \
	AND ART.TRANSACTION_CLASSIFICATION_ID IN (1, 2, 3) \
	AND ART.AR_TRANSACTION_TYPE_ID = 21 \
	AND ART.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# AR Line - Debit
ArTransaction21.sql.4.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	-AL.AMOUNT AS DEBIT, 0 as CREDIT, A.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, ART.TRANSACTION_DATE AS DATE \
	FROM AR_SERVICE_LINE AL \
	INNER JOIN AR_TRANSACTION ART ON ART.AR_TRANSACTION_ID=AL.AR_TRANSACTION_ID \
	INNER JOIN SERVICE_SETTING ALS ON ALS.SERVICE_SETTING_ID = AL.SERVICE_SETTING_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = ALS.ACCOUNT_COMBINATION_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON ART.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE AL.AMOUNT < 0 \
	AND ART.TRANSACTION_CLASSIFICATION_ID IN (1, 2, 3) \
	AND ART.AR_TRANSACTION_TYPE_ID = 21 \
	AND ART.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Withholding Tax
ArTransaction21.sql.5.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	IF(ART.AMOUNT > 0, ART.WT_AMOUNT, 0) AS DEBIT, IF(ART.AMOUNT < 0, ABS(ART.WT_AMOUNT), 0) as CREDIT, \
	A.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, ART.TRANSACTION_DATE AS DATE \
	FROM AR_TRANSACTION ART \
	INNER JOIN WT_ACCOUNT_SETTING WTAS ON WTAS.WT_ACCOUNT_SETTING_ID = ART.WT_ACCOUNT_SETTING_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = WTAS.ACCOUNT_COMBINATION_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON ART.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ART.TRANSACTION_CLASSIFICATION_ID IN (1, 2, 3) \
	AND ART.AR_TRANSACTION_TYPE_ID = 21 \
	AND ART.WT_ACCOUNT_SETTING_ID IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND ART.COMPANY_ID = AC.COMPANY_ID \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# VAT
ArTransaction21.sql.6.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	IF(AL.AMOUNT < 0, ABS(AL.VAT_AMOUNT), 0) AS DEBIT, IF(ART.AMOUNT > 0, AL.VAT_AMOUNT, 0) as CREDIT, \
	A.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, ART.TRANSACTION_DATE AS DATE \
	FROM AR_SERVICE_LINE AL \
	INNER JOIN AR_TRANSACTION ART ON ART.AR_TRANSACTION_ID = AL.AR_TRANSACTION_ID \
	INNER JOIN VAT_ACCOUNT_SETUP VAS ON IF(ART.DIVISION_ID IS NOT NULL, \
	(VAS.COMPANY_ID = ART.COMPANY_ID AND VAS.DIVISION_ID = ART.DIVISION_ID), VAS.COMPANY_ID = ART.COMPANY_ID) \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = VAS.OUTPUT_VAT_AC_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON ART.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ART.TRANSACTION_CLASSIFICATION_ID IN (1, 2, 3) \
	AND ART.AR_TRANSACTION_TYPE_ID = 21 \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND VAS.TAX_TYPE_ID = AL.TAX_TYPE_ID \
	AND AL.TAX_TYPE_ID IN (1, 8, 9) \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Withholding VAT
ArTransaction21.sql.7.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	IF(ART.AMOUNT > 0, ART.WT_VAT_AMOUNT, 0) AS DEBIT, IF(ART.AMOUNT < 0, ABS(ART.WT_VAT_AMOUNT), 0) as CREDIT, \
	A.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, ART.TRANSACTION_DATE AS DATE \
	FROM AR_TRANSACTION ART \
	INNER JOIN AR_INVOICE_ACCOUNT ARIA ON (ARIA.COMPANY_ID = ART.COMPANY_ID AND ARIA.DIVISION_ID = ART.DIVISION_ID) \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = ARIA.WT_VAT_SERVICE_AC_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON ART.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ART.TRANSACTION_CLASSIFICATION_ID IN (1, 2, 3) \
	AND ART.AR_TRANSACTION_TYPE_ID = 21 \
	AND ART.WT_VAT_AMOUNT != 0 \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND ART.COMPANY_ID = IN_COMPANY_ID
ArTransaction21.sql.bs=AND ART.GL_DATE <= IN_AS_OF_DATE \
	AND FW.IS_COMPLETE = 1
ArTransaction21.sql.is=AND ART.GL_DATE BETWEEN IN_DATE_FROM AND IN_DATE_TO \
	AND FW.IS_COMPLETE = 1