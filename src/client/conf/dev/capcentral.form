
#Description: Customer Advance Payment - Central workflow and journal entries configuration

CustomerAdvancePayment6.typeId=1
CustomerAdvancePayment6.form=customerAdvancePayment/6/viewForm
CustomerAdvancePayment6.edit=cap_central_edit
CustomerAdvancePayment6.print=customerAdvancePaymentPDF
CustomerAdvancePayment6.service=eulap.eb.service.CustomerAdvancePaymentService
CustomerAdvancePayment6.acct_transaction_types=1
CustomerAdvancePayment6.oo.parent_to_child=1
CustomerAdvancePayment6.oo.child_to_child=12003
CustomerAdvancePayment6.flow=1;2
CustomerAdvancePayment6.1.statusId=1
CustomerAdvancePayment6.1.required=
CustomerAdvancePayment6.1.next=2
CustomerAdvancePayment6.1.product_code=24084
CustomerAdvancePayment6.1.module_code=8
CustomerAdvancePayment6.2.statusId=30
CustomerAdvancePayment6.2.required=1
CustomerAdvancePayment6.2.next=0
CustomerAdvancePayment6.2.product_code=24084
CustomerAdvancePayment6.2.module_code=16
CustomerAdvancePayment6.sql.entries=1;2
# Debit - Accounts receivable
CustomerAdvancePayment6.sql.1.je=SELECT 'CUSTOMER ADVANCE PAYMENT - CENTRAL' AS SOURCE, CAP.CUSTOMER_ADVANCE_PAYMENT_ID AS ID, \
	AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER AS ACCT_NO, \
	A.ACCOUNT_NAME, CAP.RECEIPT_DATE AS GL_DATE, CONCAT('CAP', CAP_NUMBER) AS REFERENCE_NUMBER, \
	CAP.REFERENCE_NO AS DESCRIPTION, CAP.AMOUNT AS DEBIT, 0 AS CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE AS IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CUSTOMER_ADVANCE_PAYMENT CAP \
	INNER JOIN AR_CUSTOMER_ACCOUNT ARC ON ARC.AR_CUSTOMER_ACCOUNT_ID = CAP.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = ARC.DEFAULT_DEBIT_AC_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CAP.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE CAP.CUSTOMER_ADVANCE_PAYMENT_TYPE_ID = 6 \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Credit - Customer deposit account
CustomerAdvancePayment6.sql.2.je=SELECT 'CUSTOMER ADVANCE PAYMENT - CENTRAL' AS SOURCE, CAP.CUSTOMER_ADVANCE_PAYMENT_ID AS ID, \
	AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, \
	A.NUMBER AS ACCT_NO, A.ACCOUNT_NAME, CAP.RECEIPT_DATE AS GL_DATE, \
	CONCAT('CAP', CAP_NUMBER) AS REFERENCE_NUMBER, CAP.SALE_INVOICE_NO AS DESCRIPTION, \
	0 AS DEBIT, CAP.AMOUNT AS CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE AS IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CUSTOMER_ADVANCE_PAYMENT CAP \
	INNER JOIN CUSTOMER_ADVANCE_PAYMENT_ACCOUNT CAPA ON (CAPA.COMPANY_ID = CAP.COMPANY_ID AND CAPA.DIVISION_ID = CAP.DIVISION_ID) \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = CAPA.DEFAULT_CREDIT_AC_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CAP.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE CAP.CUSTOMER_ADVANCE_PAYMENT_TYPE_ID = 6 \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
CustomerAdvancePayment6.sql.je.jerr=AND CAP.RECEIPT_DATE BETWEEN DATE_FROM AND DATE_TO \
	AND (CASE WHEN IN_REFERENCE_NUMBER NOT LIKE '-1' THEN CONCAT('CAP', CAP.CAP_NUMBER) like IN_REFERENCE_NUMBER \
		ELSE IN_REFERENCE_NUMBER like IN_REFERENCE_NUMBER END) \
	AND (CASE IN_SOURCE WHEN 'CUSTOMER ADVANCE PAYMENT - CENTRAL' THEN CAP.CUSTOMER_ADVANCE_PAYMENT_ID != 0 \
		WHEN 'ALL' THEN CAP.CUSTOMER_ADVANCE_PAYMENT_ID != 0 \
		ELSE CAP.CUSTOMER_ADVANCE_PAYMENT_ID = 0 END) \
	AND (CASE WHEN IN_IS_POSTED != -1 THEN FW.IS_COMPLETE = IN_IS_POSTED ELSE FW.IS_COMPLETE != IN_IS_POSTED END)
CustomerAdvancePayment6.sql.je.ab=AND IF(DATE_FROM IS NOT NULL, CAP.RECEIPT_DATE BETWEEN DATE_FROM AND DATE_TO, CAP.RECEIPT_DATE <= DATE_TO) \
	AND IF(IN_DIVISION_ID != -1, CAP.DIVISION_ID = IN_DIVISION_ID, CAP.DIVISION_ID != IN_DIVISION_ID) \
	AND FW.IS_COMPLETE = 1
CustomerAdvancePayment6.sql.je.aa=AND D.NUMBER BETWEEN IN_FROM_DIVISION AND IN_TO_DIVISION \
	AND AC.ACCOUNT_ID = IN_ACCOUNT_ID \
	AND CAP.RECEIPT_DATE BETWEEN DATE_FROM AND DATE_TO \
	AND FW.IS_COMPLETE = 1
CustomerAdvancePayment6.sql.je.gll=AND AC.ACCOUNT_ID = IN_ACCOUNT_ID \
	AND CAP.RECEIPT_DATE BETWEEN DATE_FROM AND DATE_TO \
	AND FW.IS_COMPLETE = 1
CustomerAdvancePayment6.sql.1.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	CAP.AMOUNT as DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, CAP.RECEIPT_DATE AS DATE \
	FROM CUSTOMER_ADVANCE_PAYMENT CAP \
	INNER JOIN AR_CUSTOMER_ACCOUNT ARC ON ARC.AR_CUSTOMER_ACCOUNT_ID = CAP.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = ARC.DEFAULT_DEBIT_AC_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CAP.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE CAP.CUSTOMER_ADVANCE_PAYMENT_TYPE_ID = 6 \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
CustomerAdvancePayment6.sql.2.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 as DEBIT, CAP.AMOUNT as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, CAP.RECEIPT_DATE AS DATE \
	FROM CUSTOMER_ADVANCE_PAYMENT CAP \
	INNER JOIN CUSTOMER_ADVANCE_PAYMENT_ACCOUNT CAPA ON (CAPA.COMPANY_ID = CAP.COMPANY_ID AND CAPA.DIVISION_ID = CAP.DIVISION_ID) \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = CAPA.DEFAULT_CREDIT_AC_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CAP.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE CAP.CUSTOMER_ADVANCE_PAYMENT_TYPE_ID = 6 \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
CustomerAdvancePayment6.sql.bs=AND CAP.RECEIPT_DATE <= IN_AS_OF_DATE \
	AND FW.IS_COMPLETE = 1
CustomerAdvancePayment6.sql.is=AND CAP.RECEIPT_DATE BETWEEN IN_DATE_FROM AND IN_DATE_TO \
	AND FW.IS_COMPLETE = 1