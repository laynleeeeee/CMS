

#-- ApPayment configuration.

ApPayment.typeId=1
ApPayment.form=apPayment/form/viewForm
ApPayment.edit=ap_payment_edit
ApPayment.print=checkVoucher/pdf
ApPayment.service=eulap.eb.service.ApPaymentService
ApPayment.oo.parent_to_child=1
ApPayment.flow=1;2;3
ApPayment.1.statusId=9
ApPayment.1.required=
ApPayment.1.next=2
ApPayment.1.product_code=52
ApPayment.1.module_code=8
ApPayment.2.statusId=10
ApPayment.2.required=
ApPayment.2.next=3
ApPayment.2.product_code=52
ApPayment.2.module_code=16
ApPayment.3.statusId=16
ApPayment.3.required=1
ApPayment.3.next=0
ApPayment.3.product_code=52
ApPayment.3.module_code=32
ApPayment.sql.entries=1;2;3;4;5
# AP PAyment - Bank Account - Credit
ApPayment.sql.1.je=SELECT 'AP PAYMENT' as SOURCE, AI.AP_PAYMENT_INVOICE_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, \
	A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, AP.CHECK_DATE as GL_DATE, \
	CONCAT(AP.CHECK_NUMBER, '') as REFERENCE_NUMBER, \
	CONCAT (CASE API.INVOICE_TYPE_ID \
	WHEN 5 THEN CONCAT('RR', CAST(API.SEQUENCE_NO AS CHAR(10))) \
	WHEN 6 THEN CONCAT('RTS', CAST(API.SEQUENCE_NO AS CHAR(10))) \
	WHEN 8 THEN CONCAT('RR-RM', CAST(API.SEQUENCE_NO AS CHAR(10))) \
	ELSE API.INVOICE_NUMBER \
	END) AS DESCRIPTION, \
	0 AS DEBIT, AI.PAID_AMOUNT as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, 1 as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM AP_PAYMENT_INVOICE AI \
	INNER JOIN AP_PAYMENT AP ON AP.AP_PAYMENT_ID = AI.AP_PAYMENT_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID=AP.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN AP_INVOICE API ON API.AP_INVOICE_ID = AI.AP_INVOICE_ID \
	INNER JOIN FORM_WORKFLOW FW ON AP.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND AP.AMOUNT != 0 \
	AND AI.PAID_AMOUNT > 0 \
	AND AP.COMPANY_ID = AC.COMPANY_ID \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# AP PAyment - Bank Account - Debit
ApPayment.sql.2.je=SELECT 'AP PAYMENT' as SOURCE, AI.AP_PAYMENT_INVOICE_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, \
	A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, AP.CHECK_DATE as GL_DATE, CONCAT(AP.CHECK_NUMBER, '') as REFERENCE_NUMBER, \
	CONCAT (CASE API.INVOICE_TYPE_ID \
	WHEN 5 THEN CONCAT('RR', CAST(API.SEQUENCE_NO AS CHAR(10))) \
	WHEN 6 THEN CONCAT('RTS', CAST(API.SEQUENCE_NO AS CHAR(10))) \
	WHEN 7 THEN CONCAT('RTS-EB', CAST(API.SEQUENCE_NO AS CHAR(10))) \
	WHEN 8 THEN CONCAT('RR-RM', CAST(API.SEQUENCE_NO AS CHAR(10))) \
	ELSE API.INVOICE_NUMBER \
	END) AS DESCRIPTION, -AI.PAID_AMOUNT AS DEBIT, 0 as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, 1 as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM AP_PAYMENT_INVOICE AI \
	INNER JOIN AP_PAYMENT AP ON AP.AP_PAYMENT_ID = AI.AP_PAYMENT_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID=AP.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN AP_INVOICE API ON API.AP_INVOICE_ID = AI.AP_INVOICE_ID \
	INNER JOIN FORM_WORKFLOW FW ON AP.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND AP.AMOUNT != 0 \
	AND AI.PAID_AMOUNT < 0 \
	AND AP.COMPANY_ID = AC.COMPANY_ID \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# AP PAyment - Supplier Account - Default Credit - Credit
ApPayment.sql.3.je=SELECT 'AP PAYMENT' as SOURCE, AI.AP_PAYMENT_INVOICE_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, \
	A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, AP.CHECK_DATE as GL_DATE, CONCAT(AP.CHECK_NUMBER, '') as REFERENCE_NUMBER, \
	CONCAT (CASE API.INVOICE_TYPE_ID \
	WHEN 5 THEN CONCAT('RR', CAST(API.SEQUENCE_NO AS CHAR(10))) \
	WHEN 6 THEN CONCAT('RTS', CAST(API.SEQUENCE_NO AS CHAR(10))) \
	WHEN 7 THEN CONCAT('RTS-EB', CAST(API.SEQUENCE_NO AS CHAR(10))) \
	WHEN 8 THEN CONCAT('RR-RM', CAST(API.SEQUENCE_NO AS CHAR(10))) \
	ELSE API.INVOICE_NUMBER \
	END) AS DESCRIPTION, 0 AS DEBIT, -AI.PAID_AMOUNT as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, 1 as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM AP_PAYMENT_INVOICE AI \
	INNER JOIN AP_PAYMENT AP ON AP.AP_PAYMENT_ID = AI.AP_PAYMENT_ID \
	INNER JOIN SUPPLIER_ACCOUNT SA ON SA.SUPPLIER_ACCOUNT_ID = AP.SUPPLIER_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = SA.DEFAULT_CREDIT_AC_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN AP_INVOICE API ON API.AP_INVOICE_ID = AI.AP_INVOICE_ID \
	INNER JOIN FORM_WORKFLOW FW ON AP.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND AI.PAID_AMOUNT < 0 \
	AND AP.COMPANY_ID = AC.COMPANY_ID \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# AP PAyment - Supplier Account - Default Debit - Debit
ApPayment.sql.4.je=SELECT 'AP PAYMENT' as SOURCE, AI.AP_PAYMENT_INVOICE_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, \
	A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, AP.CHECK_DATE as GL_DATE, CONCAT(AP.CHECK_NUMBER, '') as REFERENCE_NUMBER, \
	CONCAT (CASE API.INVOICE_TYPE_ID \
	WHEN 5 THEN CONCAT('RR', CAST(API.SEQUENCE_NO AS CHAR(10))) \
	WHEN 6 THEN CONCAT('RTS', CAST(API.SEQUENCE_NO AS CHAR(10))) \
	WHEN 7 THEN CONCAT('RTS-EB', CAST(API.SEQUENCE_NO AS CHAR(10))) \
	WHEN 8 THEN CONCAT('RR-RM', CAST(API.SEQUENCE_NO AS CHAR(10))) \
	ELSE API.INVOICE_NUMBER \
	END) AS DESCRIPTION, \
	AI.PAID_AMOUNT AS DEBIT, 0 as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, 1 as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM AP_PAYMENT_INVOICE AI \
	INNER JOIN AP_PAYMENT AP ON AP.AP_PAYMENT_ID = AI.AP_PAYMENT_ID \
	INNER JOIN SUPPLIER_ACCOUNT SA ON SA.SUPPLIER_ACCOUNT_ID = AP.SUPPLIER_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = SA.DEFAULT_CREDIT_AC_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN AP_INVOICE API ON API.AP_INVOICE_ID = AI.AP_INVOICE_ID \
	INNER JOIN FORM_WORKFLOW FW ON AP.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND AI.PAID_AMOUNT >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
ApPayment.sql.je.jerr=AND AP.CHECK_DATE BETWEEN DATE_FROM and DATE_TO \
	AND (CASE WHEN IN_REFERENCE_NUMBER NOT LIKE '-1' THEN AP.CHECK_NUMBER like IN_REFERENCE_NUMBER \ 
		ELSE IN_REFERENCE_NUMBER like IN_REFERENCE_NUMBER END) \
	AND (CASE IN_SOURCE WHEN 'AP PAYMENT' THEN AP.AP_PAYMENT_ID != 0 \
		WHEN 'ALL' THEN AP.AP_PAYMENT_ID != 0 \
		ELSE AP.AP_PAYMENT_ID = 0 END) \
	AND (CASE WHEN IN_IS_POSTED != -1 THEN FW.IS_COMPLETE = IN_IS_POSTED ELSE FW.IS_COMPLETE != IN_IS_POSTED END) 
ApPayment.sql.je.ab=AND AP.CHECK_DATE <= IN_AS_OF_DATE \
	AND FW.IS_COMPLETE = 1
ApPayment.sql.je.aa=AND D.NUMBER BETWEEN IN_FROM_DIVISION AND IN_TO_DIVISION \
	AND AC.ACCOUNT_ID = IN_ACCOUNT_ID \
	AND AP.CHECK_DATE BETWEEN DATE_FROM AND DATE_TO \
	AND FW.IS_COMPLETE = 1
ApPayment.sql.je.gll=AND D.NUMBER BETWEEN IN_FROM_DIVISION AND IN_TO_DIVISION \
	AND AC.ACCOUNT_ID = IN_ACCOUNT_ID \
	AND AP.CHECK_DATE BETWEEN DATE_FROM AND DATE_TO \
	AND FW.IS_COMPLETE = 1
# Configuration for IS and BS by division
# AP PAyment - Bank Account - Credit
ApPayment.sql.1.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 AS DEBIT, AI.PAID_AMOUNT as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, AP.CHECK_DATE AS DATE\
	FROM AP_PAYMENT_INVOICE AI \
	INNER JOIN AP_PAYMENT AP ON AP.AP_PAYMENT_ID = AI.AP_PAYMENT_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID=AP.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN AP_INVOICE API ON API.AP_INVOICE_ID = AI.AP_INVOICE_ID \
	INNER JOIN FORM_WORKFLOW FW ON AP.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND AP.AMOUNT != 0 \
	AND AI.PAID_AMOUNT > 0 \
	AND AP.COMPANY_ID = AC.COMPANY_ID \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# AP PAyment - Bank Account - Debit
ApPayment.sql.2.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	-AI.PAID_AMOUNT AS DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, AP.CHECK_DATE AS DATE\
	FROM AP_PAYMENT_INVOICE AI \
	INNER JOIN AP_PAYMENT AP ON AP.AP_PAYMENT_ID = AI.AP_PAYMENT_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID=AP.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN AP_INVOICE API ON API.AP_INVOICE_ID = AI.AP_INVOICE_ID \
	INNER JOIN FORM_WORKFLOW FW ON AP.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND AP.AMOUNT != 0 \
	AND AI.PAID_AMOUNT < 0 \
	AND AP.COMPANY_ID = AC.COMPANY_ID \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# AP PAyment - Supplier Account - Default Credit - Credit
ApPayment.sql.3.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 AS DEBIT, -AI.PAID_AMOUNT as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, AP.CHECK_DATE AS DATE\
	FROM AP_PAYMENT_INVOICE AI \
	INNER JOIN AP_PAYMENT AP ON AP.AP_PAYMENT_ID = AI.AP_PAYMENT_ID \
	INNER JOIN SUPPLIER_ACCOUNT SA ON SA.SUPPLIER_ACCOUNT_ID = AP.SUPPLIER_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = SA.DEFAULT_CREDIT_AC_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN AP_INVOICE API ON API.AP_INVOICE_ID = AI.AP_INVOICE_ID \
	INNER JOIN FORM_WORKFLOW FW ON AP.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND AI.PAID_AMOUNT < 0 \
	AND AP.COMPANY_ID = AC.COMPANY_ID \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# AP PAyment - Supplier Account - Default Debit - Debit
ApPayment.sql.4.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	AI.PAID_AMOUNT AS DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, AP.CHECK_DATE AS DATE\
	FROM AP_PAYMENT_INVOICE AI \
	INNER JOIN AP_PAYMENT AP ON AP.AP_PAYMENT_ID = AI.AP_PAYMENT_ID \
	INNER JOIN SUPPLIER_ACCOUNT SA ON SA.SUPPLIER_ACCOUNT_ID = AP.SUPPLIER_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = SA.DEFAULT_CREDIT_AC_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN AP_INVOICE API ON API.AP_INVOICE_ID = AI.AP_INVOICE_ID \
	INNER JOIN FORM_WORKFLOW FW ON AP.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND AI.PAID_AMOUNT >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
ApPayment.sql.bs=AND AP.CHECK_DATE <= IN_AS_OF_DATE \
	AND FW.IS_COMPLETE = 1
ApPayment.sql.is=AND AP.CHECK_DATE BETWEEN IN_DATE_FROM AND IN_DATE_TO \
	AND FW.IS_COMPLETE = 1
