
#Description: Reclass - NSB 3 workflow and inventory report configuration

Repacking12.typeId=1
Repacking12.form=repacking/1/viewForm
Repacking12.edit=repacking_nsb3_edit
Repacking12.print=repackingJr/1/pdf
Repacking12.service=eulap.eb.service.RepackingService
Repacking12.oo.parent_to_child=1
Repacking12.flow=1;2
Repacking12.1.statusId=1
Repacking12.1.required=
Repacking12.1.next=2
Repacking12.1.product_code=24054
Repacking12.1.module_code=8
Repacking12.2.statusId=3
Repacking12.2.required=1
Repacking12.2.next=0
Repacking12.2.product_code=24054
Repacking12.2.module_code=16
Repacking12.sql.entries=1;2
# Repacked to - debit
Repacking12.sql.1.je=SELECT 'RECLASS - NSB 3' as SOURCE, RI.REPACKING_ITEM_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, \
	AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, RP.R_DATE as GL_DATE, \
	CONCAT('RC ', RP.R_NUMBER) as REFERENCE_NUMBER, RP.REMARKS AS DESCRIPTION, RI.TO_AMOUNT as DEBIT, 0 as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM REPACKING_ITEM RI \
	INNER JOIN REPACKING RP ON RP.REPACKING_ID = RI.REPACKING_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = RI.TO_ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.INVENTORY_ACCOUNT AND AC.COMPANY_ID = RP.COMPANY_ID AND AC.DIVISION_ID = RP.DIVISION_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON RP.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE RP.REPACKING_TYPE_ID = 1 \
	AND RP.DIVISION_ID = 2 \
	AND ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Repacked from - credit
Repacking12.sql.2.je=SELECT 'RECLASS - NSB 3' as SOURCE, RI.REPACKING_ITEM_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, \
	AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, RP.R_DATE as GL_DATE, \
	CONCAT('RC ', RP.R_NUMBER) as REFERENCE_NUMBER, RP.REMARKS AS DESCRIPTION, 0 as DEBIT, RI.FROM_AMOUNT as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM REPACKING_ITEM RI \
	INNER JOIN REPACKING RP ON RP.REPACKING_ID = RI.REPACKING_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = RI.FROM_ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.INVENTORY_ACCOUNT AND AC.COMPANY_ID = RP.COMPANY_ID AND AC.DIVISION_ID = RP.DIVISION_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON RP.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE RP.REPACKING_TYPE_ID = 1 \
	AND RP.DIVISION_ID = 2 \
	AND ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
Repacking12.sql.je.jerr=AND RP.R_DATE BETWEEN DATE_FROM AND DATE_TO \
	AND (CASE WHEN IN_REFERENCE_NUMBER NOT LIKE '-1' THEN CONCAT('RC ', RP.R_NUMBER) LIKE IN_REFERENCE_NUMBER \
		ELSE IN_REFERENCE_NUMBER LIKE IN_REFERENCE_NUMBER END) \
	AND (CASE IN_SOURCE WHEN 'RECLASS - NSB 3' THEN RP.REPACKING_ID != 0 \
		WHEN 'ALL' THEN RP.REPACKING_ID != 0 \
		ELSE RP.REPACKING_ID = 0 END) \
	AND (CASE WHEN IN_IS_POSTED != -1 THEN FW.IS_COMPLETE = IN_IS_POSTED ELSE FW.IS_COMPLETE != IN_IS_POSTED END)
Repacking12.sql.je.ab=AND IF(DATE_FROM IS NOT NULL, RP.R_DATE BETWEEN DATE_FROM AND DATE_TO, RP.R_DATE <= DATE_TO) \
	AND IF(IN_DIVISION_ID != -1, RP.DIVISION_ID = IN_DIVISION_ID, RP.DIVISION_ID != IN_DIVISION_ID) \
	AND FW.IS_COMPLETE = 1
Repacking12.sql.je.aa=AND D.NUMBER BETWEEN IN_FROM_DIVISION AND IN_TO_DIVISION \
	AND AC.ACCOUNT_ID = IN_ACCOUNT_ID \
	AND RP.R_DATE BETWEEN DATE_FROM AND DATE_TO \
	AND RP.R_NUMBER LIKE IN_DESCRIPTION \
	AND FW.IS_COMPLETE = 1
Repacking12.sql.je.gll=AND AC.ACCOUNT_ID = IN_ACCOUNT_ID \
	AND RP.R_DATE BETWEEN DATE_FROM AND DATE_TO \
	AND FW.IS_COMPLETE = 1
# Configuration for IS and BS by division
# Repacked to - debit
Repacking12.sql.1.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	RI.TO_AMOUNT as DEBIT, 0 as CREDIT, A.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, RP.R_DATE AS DATE \
	FROM REPACKING_ITEM RI \
	INNER JOIN REPACKING RP ON RP.REPACKING_ID = RI.REPACKING_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = RI.TO_ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.INVENTORY_ACCOUNT AND AC.COMPANY_ID = RP.COMPANY_ID AND AC.DIVISION_ID = RP.DIVISION_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON RP.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE RP.REPACKING_TYPE_ID = 1 \
	AND RP.DIVISION_ID = 2 \
	AND ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Repacked from - credit
Repacking12.sql.2.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 as DEBIT, RI.FROM_AMOUNT as CREDIT, A.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, RP.R_DATE AS DATE \
	FROM REPACKING_ITEM RI \
	INNER JOIN REPACKING RP ON RP.REPACKING_ID = RI.REPACKING_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = RI.FROM_ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.INVENTORY_ACCOUNT AND AC.COMPANY_ID = RP.COMPANY_ID AND AC.DIVISION_ID = RP.DIVISION_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON RP.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE RP.REPACKING_TYPE_ID = 1 \
	AND RP.DIVISION_ID = 2 \
	AND ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
Repacking12.sql.bs=AND RP.R_DATE <= IN_AS_OF_DATE \
	AND FW.IS_COMPLETE = 1
Repacking12.sql.is=AND RP.R_DATE BETWEEN IN_DATE_FROM AND IN_DATE_TO \
 	AND FW.IS_COMPLETE = 1
Repacking12.sql.inv.entries=1;2
Repacking12.sql.1.inv=SELECT SOURCE, WAREHOUSE_ID, ITEM_ID, STOCK_CODE, DESCRIPTION, ITEM_CATEGORY_ID, UNIT_MEASUREMENT_ID, IN_QUANTITY, \
	OUT_QUANTITY, IN_UNIT_COST, OUT_UNIT_COST, IN_TOTAL_COST, OUT_TOTAL_COST, DATE, CREATED_DATE, CURRENT_STATUS_ID, IS_COMPLETE, ACTIVE, \
	REFERENCE_NUMBER, INVOICE_NUMBER, TRANS_DESCRIPTION, SRP, PARENT_EB_OBJECT_ID, EB_OBJECT_ID, DIVISION_NAME, BMS_NUMBER, DIVISION_ID, \
	LATEST_SRP, UOM_NAME FROM ( \
	SELECT 'REPACKING FROM' AS SOURCE, RP.WAREHOUSE_ID AS WAREHOUSE_ID, RPI.FROM_ITEM_ID AS ITEM_ID, \
	I.STOCK_CODE AS STOCK_CODE, I.DESCRIPTION AS DESCRIPTION, I.ITEM_CATEGORY_ID AS ITEM_CATEGORY_ID, \
	I.UNIT_MEASUREMENT_ID as UNIT_MEASUREMENT_ID, 0 AS IN_QUANTITY, \
	RPI.QUANTITY AS OUT_QUANTITY, 0 AS IN_UNIT_COST, RPI.UNIT_COST AS OUT_UNIT_COST, 0 AS IN_TOTAL_COST, \
	(RPI.UNIT_COST * RPI.QUANTITY) AS OUT_TOTAL_COST, RP.R_DATE AS DATE, RP.CREATED_DATE, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, I.ACTIVE, \
	CONCAT('RP-FROM ', RP.R_NUMBER) AS REFERENCE_NUMBER, '' AS INVOICE_NUMBER , 'RECLASSED FROM' AS TRANS_DESCRIPTION, 0.0 AS SRP, \
	RP.EB_OBJECT_ID as PARENT_EB_OBJECT_ID, RPI.EB_OBJECT_ID as EB_OBJECT_ID, D.NAME AS DIVISION_NAME, '' AS BMS_NUMBER, D.DIVISION_ID, \
	COALESCE(ISP.SRP, 0) AS LATEST_SRP, UM.NAME AS UOM_NAME \
	FROM REPACKING_ITEM RPI \
	INNER JOIN REPACKING RP ON RP.REPACKING_ID = RPI.REPACKING_ID \
	INNER JOIN FORM_WORKFLOW FW ON FW.FORM_WORKFLOW_ID = RP.FORM_WORKFLOW_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = RPI.FROM_ITEM_ID \
	LEFT JOIN ITEM_SRP ISP ON ISP.ITEM_ID = I.ITEM_ID AND ISP.ACTIVE = 1 \
	INNER JOIN UNIT_MEASUREMENT UM ON UM.UNITOFMEASUREMENT_ID = I.UNIT_MEASUREMENT_ID \
	INNER JOIN DIVISION D ON RP.DIVISION_ID = D.DIVISION_ID \
	WHERE RP.REPACKING_TYPE_ID = 1 \
	AND RP.DIVISION_ID = 2 \
	AND RP.COMPANY_ID = IN_COMPANY_ID ) AS REPACKING_FROM_TABLE 
Repacking12.sql.2.inv=SELECT SOURCE, WAREHOUSE_ID, ITEM_ID, STOCK_CODE, DESCRIPTION, ITEM_CATEGORY_ID, UNIT_MEASUREMENT_ID, IN_QUANTITY, \
	OUT_QUANTITY, IN_UNIT_COST, OUT_UNIT_COST, IN_TOTAL_COST, OUT_TOTAL_COST, DATE, CREATED_DATE, CURRENT_STATUS_ID, IS_COMPLETE, ACTIVE, \
	REFERENCE_NUMBER, INVOICE_NUMBER, TRANS_DESCRIPTION, SRP, PARENT_EB_OBJECT_ID, EB_OBJECT_ID, DIVISION_NAME, BMS_NUMBER, DIVISION_ID, \
	LATEST_SRP, UOM_NAME FROM ( \
	SELECT 'REPACKING TO' AS SOURCE, RP.WAREHOUSE_ID AS WAREHOUSE_ID, RPI.TO_ITEM_ID AS ITEM_ID, \
	I.STOCK_CODE AS STOCK_CODE, I.DESCRIPTION AS DESCRIPTION, I.ITEM_CATEGORY_ID AS ITEM_CATEGORY_ID, \
	I.UNIT_MEASUREMENT_ID as UNIT_MEASUREMENT_ID, RPI.REPACKED_QUANTITY AS IN_QUANTITY, \
	0 AS OUT_QUANTITY, RPI.REPACKED_UNIT_COST AS IN_UNIT_COST, 0 AS OUT_UNIT_COST, (RPI.REPACKED_UNIT_COST * RPI.REPACKED_QUANTITY) AS IN_TOTAL_COST, \
	0 AS OUT_TOTAL_COST, RP.R_DATE AS DATE, RP.CREATED_DATE, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, I.ACTIVE, \
	CONCAT('RP-TO ', RP.R_NUMBER) AS REFERENCE_NUMBER, '' AS INVOICE_NUMBER , 'RECLASSED TO' AS TRANS_DESCRIPTION, 0.0 AS SRP, \
	RP.EB_OBJECT_ID as PARENT_EB_OBJECT_ID, RPI.EB_OBJECT_ID as EB_OBJECT_ID, D.NAME AS DIVISION_NAME, '' AS BMS_NUMBER, D.DIVISION_ID, \
	COALESCE(ISP.SRP, 0) AS LATEST_SRP, UM.NAME AS UOM_NAME \
	FROM REPACKING_ITEM RPI \
	INNER JOIN REPACKING RP ON RP.REPACKING_ID = RPI.REPACKING_ID \
	INNER JOIN FORM_WORKFLOW FW ON FW.FORM_WORKFLOW_ID = RP.FORM_WORKFLOW_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = RPI.TO_ITEM_ID \
	LEFT JOIN ITEM_SRP ISP ON ISP.ITEM_ID = I.ITEM_ID AND ISP.ACTIVE = 1 \
	INNER JOIN UNIT_MEASUREMENT UM ON UM.UNITOFMEASUREMENT_ID = I.UNIT_MEASUREMENT_ID \
	INNER JOIN DIVISION D ON RP.DIVISION_ID = D.DIVISION_ID \
	WHERE RP.REPACKING_TYPE_ID = 1 \
	AND RP.DIVISION_ID = 2 \
	AND RP.COMPANY_ID = IN_COMPANY_ID ) AS REPACKING_TO_TABLE 
Repacking12.sql.inv.as=WHERE IS_COMPLETE = 1 \
	AND ITEM_ID = IN_ITEM_ID \
	AND WAREHOUSE_ID = IN_WAREHOUSE_ID \
	AND DATE <= IN_DATE
Repacking12.sql.inv.rsf=WHERE IS_COMPLETE = 1 \
	AND ITEM_ID = IN_ITEM_ID \
	AND WAREHOUSE_ID = IN_WAREHOUSE_ID \
	AND DATE > IN_DATE
Repacking12.sql.inv.il=WHERE DATE <= IN_DATE \
	AND IF(IN_ITEM_CATEGORY_ID != -1, ITEM_CATEGORY_ID = IN_ITEM_CATEGORY_ID, ITEM_CATEGORY_ID != 0) \
	AND IF(IN_WAREHOUSE_ID != -1, WAREHOUSE_ID = IN_WAREHOUSE_ID, WAREHOUSE_ID != IN_WAREHOUSE_ID) \
	AND IF(IN_IS_ACTIVE != -1, ACTIVE = IN_IS_ACTIVE, ACTIVE != IN_IS_ACTIVE ) \
	AND IF(IN_DIVISION_ID != -1, DIVISION_ID = IN_DIVISION_ID, DIVISION_ID != IN_DIVISION_ID) \
	AND CASE WHEN IN_STATUS = -1 THEN CURRENT_STATUS_ID != 4 WHEN IN_STATUS = 1 THEN IS_COMPLETE = 1 END
Repacking12.sql.inv.sc=WHERE IS_COMPLETE = 1 \
	AND ITEM_ID = IN_ITEM_ID \
	AND WAREHOUSE_ID = IN_WAREHOUSE_ID \
	AND DATE BETWEEN IN_START_DATE AND IN_END_DATE \
	AND DIVISION_ID = IN_DIVISION_ID
Repacking12.sql.inv.ft=WHERE IS_COMPLETE = 1 \
	AND ITEM_ID = IN_ITEM_ID \
	AND WAREHOUSE_ID = IN_WAREHOUSE_ID \
	AND DATE > DATE_TO