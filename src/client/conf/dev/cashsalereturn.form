
# Description: Cash Sale Return workflow and journal entries configuration

CashSaleReturn1.typeId=1
CashSaleReturn1.form=cashSaleReturn/form/1/viewForm
CashSaleReturn1.edit=cash_sale_return_edit
CashSaleReturn1.print=cashSaleReturnPDF/1/pdf
CashSaleReturn1.service=eulap.eb.service.CashSaleReturnService
CashSaleReturn1.oo.parent_to_child=1
CashSaleReturn1.oo.child_to_child=6
CashSaleReturn1.flow=1;2
CashSaleReturn1.1.statusId=1
CashSaleReturn1.1.required=
CashSaleReturn1.1.next=2
CashSaleReturn1.1.product_code=101
CashSaleReturn1.1.module_code=8
CashSaleReturn1.2.statusId=7
CashSaleReturn1.2.required=1
CashSaleReturn1.2.next=0
CashSaleReturn1.2.product_code=101
CashSaleReturn1.2.module_code=16
CashSaleReturn1.sql.entries=1;2;3;4;5;6;7;8;9;10;11;12;13;14;15;16;17;18;19;20;21;22;23;24;25;26;27;28;29;30;31;32;33;34;35;36;37;38
# Cash Sales Return - Cost Account - returned Item/s
CashSaleReturn1.sql.1.je=SELECT 'CASH SALES RETURN' as SOURCE, CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CS-', CS_NUMBER) AS DESCRIPTION, \
	0 as DEBIT, COALESCE(UNIT_COST, 0) * ABS(QUANTITY) as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.COST_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND UNIT_COST IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.AMOUNT < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Cost Account - exchanged Item/s
CashSaleReturn1.sql.2.je=SELECT 'CASH SALES RETURN' as SOURCE, CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CS-', CS_NUMBER) AS DESCRIPTION, \
	COALESCE(UNIT_COST, 0) * QUANTITY as DEBIT, 0 as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.COST_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND UNIT_COST IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of Returns) - Cost Account - returned item/s
CashSaleReturn1.sql.3.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CSR-', CS.CSR_NUMBER) AS DESCRIPTION, \
	0 as DEBIT, COALESCE(UNIT_COST, 0) * ABS(QUANTITY) as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.COST_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND UNIT_COST IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of Returns) - Cost Account - exchanged item/s
CashSaleReturn1.sql.4.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CSR-', CS.CSR_NUMBER) AS DESCRIPTION, \
	COALESCE(UNIT_COST, 0) * QUANTITY as DEBIT, 0 as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.COST_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND UNIT_COST IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Inventory Account - returned item/s
CashSaleReturn1.sql.5.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CS-', CS_NUMBER) AS DESCRIPTION, \
	COALESCE(UNIT_COST, 0) * ABS(QUANTITY) as DEBIT, 0 as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.INVENTORY_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND UNIT_COST IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Inventory Account - exchanged item/s
CashSaleReturn1.sql.6.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CS-', CS_NUMBER) AS DESCRIPTION, \
	0 as DEBIT, COALESCE(UNIT_COST, 0) * QUANTITY as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.INVENTORY_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND UNIT_COST IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Inventory Account - returned item/s
CashSaleReturn1.sql.7.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CSR-', CS.CSR_NUMBER) AS DESCRIPTION, \
	COALESCE(UNIT_COST, 0) * ABS(QUANTITY) as DEBIT, 0 as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.INVENTORY_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND UNIT_COST IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Inventory Account - exchanged item/s
CashSaleReturn1.sql.8.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CSR-', CS.CSR_NUMBER) AS DESCRIPTION, \
	0 as DEBIT, COALESCE(UNIT_COST, 0) * QUANTITY as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.INVENTORY_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND UNIT_COST IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Sales Return Account - returned item/s
CashSaleReturn1.sql.9.je=SELECT 'CASH SALES RETURN' as SOURCE, CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CS-', CS_NUMBER) AS DESCRIPTION, ABS(QUANTITY * SRP) - ABS(COALESCE(CSRI.VAT_AMOUNT, 0)) as DEBIT, \
	0 as CREDIT, FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.SALES_RETURN_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Sales Return Account - exchanged item/s
CashSaleReturn1.sql.10.je=SELECT 'CASH SALES RETURN' as SOURCE, CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CS-', CS_NUMBER) AS DESCRIPTION, 0 as DEBIT, \
	(QUANTITY * SRP) - COALESCE(CSRI.VAT_AMOUNT, 0) as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.SALES_RETURN_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Sales Return Account - returned item/s
CashSaleReturn1.sql.11.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CSR-', CS.CSR_NUMBER) AS DESCRIPTION, ABS(QUANTITY * SRP) - ABS(COALESCE(CSRI.VAT_AMOUNT, 0)) as DEBIT, \
	0 as CREDIT, FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.SALES_RETURN_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Sales Return Account - exchanged item/s
CashSaleReturn1.sql.12.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CSR-', CS.CSR_NUMBER) AS DESCRIPTION, \
	0 as DEBIT, (QUANTITY * SRP) - COALESCE(CSRI.VAT_AMOUNT, 0) as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.SALES_RETURN_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Return Sales - Sales Discount Account
CashSaleReturn1.sql.13.je=SELECT 'CASH SALES RETURN' as SOURCE, CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CS-', CS_NUMBER) AS DESCRIPTION, \
	0 AS DEBIT, ABS(COALESCE(DISCOUNT, 0)) as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.SALES_DISCOUNT_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND DISCOUNT IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Return Sales (Return of returns) - Sales Discount Account
CashSaleReturn1.sql.14.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CSR-', CS.CSR_NUMBER) AS DESCRIPTION, \
	0 AS DEBIT, COALESCE(DISCOUNT, 0) as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.SALES_DISCOUNT_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND DISCOUNT IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Receipt Method - Default Debit - returned item/s
CashSaleReturn1.sql.15.je=SELECT 'CASH SALES RETURN' as SOURCE, CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CS-', CS_NUMBER) AS DESCRIPTION, 0 as DEBIT, \
	ABS(CSRI.AMOUNT) + ABS(COALESCE(CSRI.VAT_AMOUNT, 0)) as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON  \
		(AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Receipt Method - Default Debit - exchanged item/s
CashSaleReturn1.sql.16.je=SELECT 'CASH SALES RETURN' as SOURCE, CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CS-', CS_NUMBER) AS DESCRIPTION, CSRI.AMOUNT + (COALESCE(CSRI.VAT_AMOUNT, 0)) as DEBIT, \
	0 as CREDIT, FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON  \
		(AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Receipt Method - Default Debit - returned item/s
CashSaleReturn1.sql.17.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CSR-', CS.CSR_NUMBER) AS DESCRIPTION, 0 as DEBIT, \
	ABS(CSRI.AMOUNT) + ABS(COALESCE(CSRI.VAT_AMOUNT, 0)) as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Receipt Method - Default Debit - exchanged item/s
CashSaleReturn1.sql.18.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CSR-', CS.CSR_NUMBER) AS DESCRIPTION, CSRI.AMOUNT + (COALESCE(CSRI.VAT_AMOUNT, 0)) as DEBIT, \
	0 as CREDIT, FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Receipt Method - Bank Account
CashSaleReturn1.sql.19.je=SELECT 'CASH SALES RETURN' as SOURCE, CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CS-', CS_NUMBER) AS DESCRIPTION, 0 as DEBIT, \
	ABS(CSRI.AMOUNT) + ABS(COALESCE(CSRI.VAT_AMOUNT, 0)) as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID = RM.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Receipt Method - Bank Account
CashSaleReturn1.sql.20.je=SELECT 'CASH SALES RETURN' as SOURCE, CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CS-', CS_NUMBER) AS DESCRIPTION, CSRI.AMOUNT + (COALESCE(CSRI.VAT_AMOUNT, 0)) as DEBIT, \
	0 as CREDIT, FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID = RM.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Receipt Method - Bank Account - returned item/s
CashSaleReturn1.sql.21.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CSR-', CS.CSR_NUMBER) AS DESCRIPTION, 0 as DEBIT, \
	ABS(CSRI.AMOUNT) + ABS(COALESCE(CSRI.VAT_AMOUNT, 0)) as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID = RM.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON  \
	(AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.AMOUNT < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Receipt Method - Bank Account - exchanged item/s
CashSaleReturn1.sql.22.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CSR-', CS.CSR_NUMBER) AS DESCRIPTION, CSRI.AMOUNT + COALESCE(CSRI.VAT_AMOUNT, 0) as DEBIT, \
	0 as CREDIT, FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID = RM.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON  \
	(AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.AMOUNT >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Other Charges - NEGATIVE AMOUNT
CashSaleReturn1.sql.23.je=SELECT 'CASH SALES RETURN' as SOURCE, CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CS-', CS_NUMBER) AS DESCRIPTION, \
	ABS(AL.AMOUNT) AS DEBIT, 0 as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_AR_LINE AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_LINE_SETUP ALS ON ALS.AR_LINE_SETUP_ID = AL.AR_LINE_SETUP_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = ALS.ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AL.AMOUNT < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Other Charges - POSITVE AMOUNT
CashSaleReturn1.sql.24.je=SELECT 'CASH SALES RETURN' as SOURCE, CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CS-', CS_NUMBER) AS DESCRIPTION, \
	0 AS DEBIT, AL.AMOUNT as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_AR_LINE AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_LINE_SETUP ALS ON ALS.AR_LINE_SETUP_ID = AL.AR_LINE_SETUP_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = ALS.ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AL.AMOUNT >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Other Charges - NEGATIVE AMOUNT
CashSaleReturn1.sql.25.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CSR-', CS.CSR_NUMBER) AS DESCRIPTION, \
	ABS(AL.AMOUNT) AS DEBIT, 0 as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_AR_LINE AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN AR_LINE_SETUP ALS ON ALS.AR_LINE_SETUP_ID = AL.AR_LINE_SETUP_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = ALS.ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AL.AMOUNT < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Other Charges - POSITIVE AMOUNT
CashSaleReturn1.sql.26.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CSR-', CS.CSR_NUMBER) AS DESCRIPTION, \
	0 AS DEBIT, AL.AMOUNT as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_AR_LINE AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN AR_LINE_SETUP ALS ON ALS.AR_LINE_SETUP_ID = AL.AR_LINE_SETUP_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = ALS.ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AL.AMOUNT >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales RETURN - Receipt Method - Default Debit - AR Lines
CashSaleReturn1.sql.27.je=SELECT 'CASH SALES RETURN' as SOURCE, CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CS-', CS_NUMBER) AS DESCRIPTION, 0 AS DEBIT, \
	IF(AL.AMOUNT < 0, (ABS(AL.AMOUNT) + ABS(COALESCE(AL.VAT_AMOUNT, 0))), -(AL.AMOUNT + COALESCE(AL.VAT_AMOUNT, 0))) as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_AR_LINE AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales RETURN - Receipt Method - Bank Account - AR Lines
CashSaleReturn1.sql.28.je=SELECT 'CASH SALES RETURN' as SOURCE, CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CS-', CS_NUMBER) AS DESCRIPTION, 0 AS DEBIT, \
	IF(AL.AMOUNT < 0, (ABS(AL.AMOUNT) + ABS(COALESCE(AL.VAT_AMOUNT, 0))), -(AL.AMOUNT + COALESCE(AL.VAT_AMOUNT, 0))) as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_AR_LINE AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID = RM.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales RETURN (Return of returns) - Receipt Method - Default Debit - AR Lines
CashSaleReturn1.sql.29.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CSR-', CS.CSR_NUMBER) AS DESCRIPTION, 0 AS DEBIT, \
	IF(AL.AMOUNT < 0, (ABS(AL.AMOUNT) + ABS(COALESCE(AL.VAT_AMOUNT, 0))), -(AL.AMOUNT + COALESCE(AL.VAT_AMOUNT, 0))) as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_AR_LINE AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales RETURN (Return of returns) - Receipt Method - Bank Account - AR Lines
CashSaleReturn1.sql.30.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CSR-', CS.CSR_NUMBER) AS DESCRIPTION, 0 AS DEBIT, \
	IF(AL.AMOUNT < 0, (ABS(AL.AMOUNT) + ABS(COALESCE(AL.VAT_AMOUNT, 0))), -(AL.AMOUNT + COALESCE(AL.VAT_AMOUNT, 0))) as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_AR_LINE AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID = RM.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# CSR OUTPUT VAT
CashSaleReturn1.sql.31.je=SELECT 'CASH SALES RETURN' AS SOURCE, CSR.CASH_SALE_RETURN_ID AS ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, \
	A.NUMBER AS ACCT_NO, A.ACCOUNT_NAME, CSR.DATE AS GL_DATE, CONCAT('CSR ', CSR_NUMBER) AS REFERENCE_NUMBER, \
	CONCAT('CS-', CS_NUMBER) AS DESCRIPTION, IF(AL.AMOUNT < 0, ABS(COALESCE(AL.VAT_AMOUNT, 0)), 0) AS DEBIT, \
	IF(AL.AMOUNT > 0, COALESCE(AL.VAT_AMOUNT, 0), 0) AS CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE AS IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_AR_LINE AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN VAT_ACCOUNT_SETUP IA ON IA.OUTPUT_VAT_AC_ID = AC.ACCOUNT_COMBINATION_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSR.COMPANY_ID = IN_COMPANY_ID
CashSaleReturn1.sql.32.je=SELECT 'CASH SALES RETURN' AS SOURCE, CSR.CASH_SALE_RETURN_ID AS ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, \
	A.NUMBER AS ACCT_NO, A.ACCOUNT_NAME, CSR.DATE AS GL_DATE, CONCAT('CSR ', CSR_NUMBER) AS REFERENCE_NUMBER, \
	CONCAT('CS-', CS_NUMBER) AS DESCRIPTION, IF(AL.QUANTITY < 0, ABS(COALESCE(AL.VAT_AMOUNT, 0)), 0) AS DEBIT, \
	IF(AL.QUANTITY > 0, COALESCE(AL.VAT_AMOUNT, 0), 0) AS CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE AS IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN_ITEM AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN VAT_ACCOUNT_SETUP IA ON IA.OUTPUT_VAT_AC_ID = AC.ACCOUNT_COMBINATION_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSR.COMPANY_ID = IN_COMPANY_ID
# CSR - receipt method - default debit - withholding tax
CashSaleReturn1.sql.33.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CS-', CS.CS_NUMBER) AS DESCRIPTION, IF(CSR.WT_AMOUNT > 0, -CSR.WT_AMOUNT, 0) AS DEBIT, \
    IF(CSR.WT_AMOUNT < 0, CSR.WT_AMOUNT, 0) AS CREDIT, FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, \
    FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN CSR \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON (AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID \
        AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
    AND CSR.WT_ACCOUNT_SETTING_ID IS NOT NULL \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# CSR (Return of returns) - receipt method - default debit - withholding tax
CashSaleReturn1.sql.34.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CSR-', CS.CSR_NUMBER) AS DESCRIPTION, IF(CSR.WT_AMOUNT > 0, -CSR.WT_AMOUNT, 0) AS DEBIT, \
    IF(CSR.WT_AMOUNT < 0, CSR.WT_AMOUNT, 0) AS CREDIT, FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, \
    FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN CSR \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON (AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID \
        AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
    AND CSR.WT_ACCOUNT_SETTING_ID IS NOT NULL \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# CSR - receipt method - bank account - withholding tax
CashSaleReturn1.sql.35.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CS-', CS.CS_NUMBER) AS DESCRIPTION, IF(CSR.WT_AMOUNT > 0, -CSR.WT_AMOUNT, 0) AS DEBIT, \
    IF(CSR.WT_AMOUNT < 0, CSR.WT_AMOUNT, 0) AS CREDIT, FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, \
    FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN CSR \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID = RM.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON (AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID \
        AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
    AND CSR.WT_ACCOUNT_SETTING_ID IS NOT NULL \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# CSR (Return of returns) - receipt method - bank account - withholding tax
CashSaleReturn1.sql.36.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CSR-', CS.CSR_NUMBER) AS DESCRIPTION, IF(CSR.WT_AMOUNT > 0, -CSR.WT_AMOUNT, 0) AS DEBIT, \
    IF(CSR.WT_AMOUNT < 0, CSR.WT_AMOUNT, 0) AS CREDIT, FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, \
    FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN CSR \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID = RM.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON  \
	(AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
    AND CSR.WT_ACCOUNT_SETTING_ID IS NOT NULL \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# CSR - withholding tax
CashSaleReturn1.sql.37.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CS-', CS.CS_NUMBER) AS DESCRIPTION, IF(CSR.WT_AMOUNT > 0, CSR.WT_AMOUNT, 0) AS DEBIT, \
    IF(CSR.WT_AMOUNT < 0, ABS(CSR.WT_AMOUNT), 0) AS CREDIT, FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, \
    FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN CSR \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
    INNER JOIN WT_ACCOUNT_SETTING WTAS ON WTAS.WT_ACCOUNT_SETTING_ID = CSR.WT_ACCOUNT_SETTING_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = WTAS.ACCOUNT_COMBINATION_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
    AND CSR.WT_ACCOUNT_SETTING_ID IS NOT NULL \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# CSR (Return of returns) - withholding tax
CashSaleReturn1.sql.38.je=SELECT 'CASH SALES RETURN' as SOURCE,  CSR.CASH_SALE_RETURN_ID as ID, AC.COMPANY_ID, \
	AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, \
	A.ACCOUNT_NAME, CSR.DATE as GL_DATE, CONCAT('CSR ', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CONCAT('CSR-', CS.CSR_NUMBER) AS DESCRIPTION, IF(CSR.WT_AMOUNT > 0, CSR.WT_AMOUNT, 0) AS DEBIT, \
    IF(CSR.WT_AMOUNT < 0, ABS(CSR.WT_AMOUNT), 0) AS CREDIT, FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, \
    FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM CASH_SALE_RETURN CSR \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
    INNER JOIN WT_ACCOUNT_SETTING WTAS ON WTAS.WT_ACCOUNT_SETTING_ID = CSR.WT_ACCOUNT_SETTING_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = WTAS.ACCOUNT_COMBINATION_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
    AND CSR.WT_ACCOUNT_SETTING_ID IS NOT NULL \
	AND AC.COMPANY_ID = IN_COMPANY_ID
CashSaleReturn1.sql.je.jerr=AND CSR.DATE BETWEEN DATE_FROM AND DATE_TO \
	AND (CASE WHEN IN_REFERENCE_NUMBER NOT LIKE '-1' THEN CONCAT('CSR', CSR.CSR_NUMBER) LIKE IN_REFERENCE_NUMBER \
		ELSE IN_REFERENCE_NUMBER LIKE IN_REFERENCE_NUMBER END) \
	AND (CASE IN_SOURCE WHEN 'CASH SALES RETURN' THEN CSR.CASH_SALE_RETURN_ID != 0 \
		WHEN 'ALL' THEN CSR.CASH_SALE_RETURN_ID != 0 \
		ELSE CSR.CASH_SALE_RETURN_ID = 0 END) \
	AND (CASE WHEN IN_IS_POSTED != -1 THEN FW.IS_COMPLETE = IN_IS_POSTED ELSE FW.IS_COMPLETE != IN_IS_POSTED END)
CashSaleReturn1.sql.je.ab=AND CSR.DATE <= IN_AS_OF_DATE \
	AND FW.IS_COMPLETE = 1
CashSaleReturn1.sql.je.aa=AND D.NUMBER BETWEEN IN_FROM_DIVISION AND IN_TO_DIVISION \
	AND AC.ACCOUNT_ID = IN_ACCOUNT_ID \
	AND CSR.DATE BETWEEN DATE_FROM AND DATE_TO \
	AND CSR.SALE_INVOICE_NO LIKE IN_DESCRIPTION \
	AND FW.IS_COMPLETE = 1
CashSaleReturn1.sql.je.gll=AND AC.ACCOUNT_ID = IN_ACCOUNT_ID \
	AND CSR.DATE BETWEEN DATE_FROM AND DATE_TO \
	AND FW.IS_COMPLETE = 1
# Configuration for IS and BS by division
# Cash Sales Return - Cost Account - returned Item/s
CashSaleReturn1.sql.1.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 as DEBIT, COALESCE(UNIT_COST, 0) * ABS(QUANTITY) as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.COST_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND UNIT_COST IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.AMOUNT < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Cost Account - exchanged Item/s
CashSaleReturn1.sql.2.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	COALESCE(UNIT_COST, 0) * QUANTITY as DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.COST_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND UNIT_COST IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of Returns) - Cost Account - returned item/s
CashSaleReturn1.sql.3.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 as DEBIT, COALESCE(UNIT_COST, 0) * ABS(QUANTITY) as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.COST_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND UNIT_COST IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of Returns) - Cost Account - exchanged item/s
CashSaleReturn1.sql.4.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	COALESCE(UNIT_COST, 0) * QUANTITY as DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.COST_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND UNIT_COST IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Inventory Account - returned item/s
CashSaleReturn1.sql.5.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	COALESCE(UNIT_COST, 0) * ABS(QUANTITY) as DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.INVENTORY_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND UNIT_COST IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Inventory Account - exchanged item/s
CashSaleReturn1.sql.6.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 as DEBIT, COALESCE(UNIT_COST, 0) * QUANTITY as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.INVENTORY_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND UNIT_COST IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Inventory Account - returned item/s
CashSaleReturn1.sql.7.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	COALESCE(UNIT_COST, 0) * ABS(QUANTITY) as DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.INVENTORY_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND UNIT_COST IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Inventory Account - exchanged item/s
CashSaleReturn1.sql.8.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 as DEBIT, COALESCE(UNIT_COST, 0) * QUANTITY as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.INVENTORY_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND UNIT_COST IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Sales Return Account - returned item/s
CashSaleReturn1.sql.9.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	ABS(QUANTITY * SRP) - ABS(COALESCE(CSRI.VAT_AMOUNT, 0)) as DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.SALES_RETURN_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Sales Return Account - exchanged item/s
CashSaleReturn1.sql.10.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 as DEBIT, (QUANTITY * SRP) - COALESCE(CSRI.VAT_AMOUNT, 0) as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.SALES_RETURN_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Sales Return Account - returned item/s
CashSaleReturn1.sql.11.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	ABS(QUANTITY * SRP) - ABS(COALESCE(CSRI.VAT_AMOUNT, 0)) as DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.SALES_RETURN_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Sales Return Account - exchanged item/s
CashSaleReturn1.sql.12.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 as DEBIT, (QUANTITY * SRP) - COALESCE(CSRI.VAT_AMOUNT, 0) as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.SALES_RETURN_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Return Sales - Sales Discount Account
CashSaleReturn1.sql.13.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 AS DEBIT, ABS(COALESCE(DISCOUNT, 0)) as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.SALES_DISCOUNT_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND DISCOUNT IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Return Sales (Return of returns) - Sales Discount Account
CashSaleReturn1.sql.14.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 AS DEBIT, COALESCE(DISCOUNT, 0) as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN AR_CUSTOMER_ACCOUNT ACA ON ACA.AR_CUSTOMER_ACCOUNT_ID = CSR.AR_CUSTOMER_ACCOUNT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = CSRI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.SALES_DISCOUNT_ACCOUNT AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND DISCOUNT IS NOT NULL \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Receipt Method - Default Debit - returned item/s
CashSaleReturn1.sql.15.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 as DEBIT, ABS(CSRI.AMOUNT) + ABS(COALESCE(CSRI.VAT_AMOUNT, 0)) as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON  \
		(AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Receipt Method - Default Debit - exchanged item/s
CashSaleReturn1.sql.16.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	CSRI.AMOUNT + (COALESCE(CSRI.VAT_AMOUNT, 0)) as DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON  \
		(AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Receipt Method - Default Debit - returned item/s
CashSaleReturn1.sql.17.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 as DEBIT, ABS(CSRI.AMOUNT) + ABS(COALESCE(CSRI.VAT_AMOUNT, 0)) as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Receipt Method - Default Debit - exchanged item/s
CashSaleReturn1.sql.18.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	CSRI.AMOUNT + (COALESCE(CSRI.VAT_AMOUNT, 0)) as DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Receipt Method - Bank Account
CashSaleReturn1.sql.19.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 as DEBIT, ABS(CSRI.AMOUNT) + ABS(COALESCE(CSRI.VAT_AMOUNT, 0)) as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID = RM.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Receipt Method - Bank Account
CashSaleReturn1.sql.20.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	CSRI.AMOUNT + (COALESCE(CSRI.VAT_AMOUNT, 0)) as DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID = RM.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.QUANTITY >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Receipt Method - Bank Account - returned item/s
CashSaleReturn1.sql.21.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 as DEBIT, ABS(CSRI.AMOUNT) + ABS(COALESCE(CSRI.VAT_AMOUNT, 0)) as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID = RM.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON  \
	(AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.AMOUNT < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Receipt Method - Bank Account - exchanged item/s
CashSaleReturn1.sql.22.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	CSRI.AMOUNT + COALESCE(CSRI.VAT_AMOUNT, 0) as DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID = RM.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON  \
	(AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSRI.AMOUNT >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Other Charges - NEGATIVE AMOUNT
CashSaleReturn1.sql.23.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	ABS(AL.AMOUNT) AS DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_AR_LINE AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_LINE_SETUP ALS ON ALS.AR_LINE_SETUP_ID = AL.AR_LINE_SETUP_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = ALS.ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AL.AMOUNT < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return - Other Charges - POSITVE AMOUNT
CashSaleReturn1.sql.24.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 AS DEBIT, AL.AMOUNT as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_AR_LINE AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_LINE_SETUP ALS ON ALS.AR_LINE_SETUP_ID = AL.AR_LINE_SETUP_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = ALS.ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AL.AMOUNT >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Other Charges - NEGATIVE AMOUNT
CashSaleReturn1.sql.25.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	ABS(AL.AMOUNT) AS DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_AR_LINE AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN AR_LINE_SETUP ALS ON ALS.AR_LINE_SETUP_ID = AL.AR_LINE_SETUP_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = ALS.ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AL.AMOUNT < 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales Return (Return of returns) - Other Charges - POSITIVE AMOUNT
CashSaleReturn1.sql.26.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 AS DEBIT, AL.AMOUNT as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_AR_LINE AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN AR_LINE_SETUP ALS ON ALS.AR_LINE_SETUP_ID = AL.AR_LINE_SETUP_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = ALS.ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AL.AMOUNT >= 0 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales RETURN - Receipt Method - Default Debit - Ar Lines - NEGATIVE AMOUNT
CashSaleReturn1.sql.27.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 AS DEBIT, ABS(AL.AMOUNT) + ABS(COALESCE(AL.VAT_AMOUNT, 0)) as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_AR_LINE AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales RETURN - Receipt Method - Default Debit - Ar Lines - POSITIVE AMOUNT
CashSaleReturn1.sql.28.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	AL.AMOUNT + COALESCE(AL.VAT_AMOUNT, 0) AS DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_AR_LINE AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID = RM.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales RETURN (Return of returns) - Receipt Method - Default Debit - Ar Lines - NEGATIVE AMOUNT
CashSaleReturn1.sql.29.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 AS DEBIT, ABS(AL.AMOUNT) + COALESCE(AL.VAT_AMOUNT, 0) as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_AR_LINE AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Cash Sales RETURN (Return of returns) - Receipt Method - Default Debit - Ar Lines - POSITIVE AMOUNT
CashSaleReturn1.sql.30.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	AL.AMOUNT + COALESCE(AL.VAT_AMOUNT, 0) AS DEBIT, 0 as CREDIT, AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_AR_LINE AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID = RM.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
		(AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# CSR OUTPUT VAT
CashSaleReturn1.sql.31.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	IF(AL.AMOUNT < 0, ABS(COALESCE(AL.VAT_AMOUNT, 0)), 0) AS DEBIT, \
	IF(AL.AMOUNT > 0, COALESCE(AL.VAT_AMOUNT, 0), 0) AS CREDIT, \
	AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_AR_LINE AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN VAT_ACCOUNT_SETUP IA ON IA.OUTPUT_VAT_AC_ID = AC.ACCOUNT_COMBINATION_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSR.COMPANY_ID = IN_COMPANY_ID
CashSaleReturn1.sql.32.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	IF(AL.QUANTITY < 0, ABS(COALESCE(AL.VAT_AMOUNT, 0)), 0) AS DEBIT, \
	IF(AL.QUANTITY > 0, COALESCE(AL.VAT_AMOUNT, 0), 0) AS CREDIT, \
	AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN_ITEM AL \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = AL.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN VAT_ACCOUNT_SETUP IA ON IA.OUTPUT_VAT_AC_ID = AC.ACCOUNT_COMBINATION_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
	AND CSR.COMPANY_ID = IN_COMPANY_ID
# CSR - receipt method - default debit - withholding tax
CashSaleReturn1.sql.33.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	IF(CSR.WT_AMOUNT > 0, -CSR.WT_AMOUNT, 0) AS DEBIT, IF(CSR.WT_AMOUNT < 0, CSR.WT_AMOUNT, 0) AS CREDIT, \
	AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN CSR \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON (AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID \
        AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
    AND CSR.WT_ACCOUNT_SETTING_ID IS NOT NULL \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# CSR (Return of returns) - receipt method - default debit - withholding tax
CashSaleReturn1.sql.34.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	IF(CSR.WT_AMOUNT > 0, -CSR.WT_AMOUNT, 0) AS DEBIT, IF(CSR.WT_AMOUNT < 0, CSR.WT_AMOUNT, 0) AS CREDIT, \
	AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN CSR \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON (AC.ACCOUNT_COMBINATION_ID = RM.DEBIT_ACCOUNT_COMBINATION_ID \
        AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
    AND CSR.WT_ACCOUNT_SETTING_ID IS NOT NULL \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# CSR - receipt method - bank account - withholding tax
CashSaleReturn1.sql.35.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	IF(CSR.WT_AMOUNT > 0, -CSR.WT_AMOUNT, 0) AS DEBIT, IF(CSR.WT_AMOUNT < 0, CSR.WT_AMOUNT, 0) AS CREDIT, \
	AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN CSR \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID = RM.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON (AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID \
        AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
    AND CSR.WT_ACCOUNT_SETTING_ID IS NOT NULL \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# CSR (Return of returns) - receipt method - bank account - withholding tax
CashSaleReturn1.sql.36.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	IF(CSR.WT_AMOUNT > 0, -CSR.WT_AMOUNT, 0) AS DEBIT, IF(CSR.WT_AMOUNT < 0, CSR.WT_AMOUNT, 0) AS CREDIT, \
	AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN CSR \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
	INNER JOIN INVENTORY_ACCOUNT IA ON IA.COMPANY_ID = CSR.COMPANY_ID \
	INNER JOIN RECEIPT_METHOD RM ON RM.RECEIPT_METHOD_ID = IA.CASH_SALES_RM_ID \
	INNER JOIN BANK_ACCOUNT BA ON BA.BANK_ACCOUNT_ID = RM.BANK_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON  \
	(AC.ACCOUNT_COMBINATION_ID = BA.CASH_IN_BANK_ACCT_ID AND AC.COMPANY_ID = CSR.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
    AND CSR.WT_ACCOUNT_SETTING_ID IS NOT NULL \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# CSR - withholding tax
CashSaleReturn1.sql.37.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	IF(CSR.WT_AMOUNT > 0, CSR.WT_AMOUNT, 0) AS DEBIT, IF(CSR.WT_AMOUNT < 0, ABS(CSR.WT_AMOUNT), 0) AS CREDIT, \
	AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN CSR \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
    INNER JOIN WT_ACCOUNT_SETTING WTAS ON WTAS.WT_ACCOUNT_SETTING_ID = CSR.WT_ACCOUNT_SETTING_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = WTAS.ACCOUNT_COMBINATION_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
    AND CSR.WT_ACCOUNT_SETTING_ID IS NOT NULL \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# CSR (Return of returns) - withholding tax
CashSaleReturn1.sql.38.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	IF(CSR.WT_AMOUNT > 0, CSR.WT_AMOUNT, 0) AS DEBIT, IF(CSR.WT_AMOUNT < 0, ABS(CSR.WT_AMOUNT), 0) AS CREDIT, \
	AT.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO,  CSR.DATE AS DATE \
	FROM CASH_SALE_RETURN CSR \
	INNER JOIN CASH_SALE_RETURN CS ON CS.CASH_SALE_RETURN_ID = CSR.REF_CASH_SALE_RETURN_ID \
    INNER JOIN WT_ACCOUNT_SETTING WTAS ON WTAS.WT_ACCOUNT_SETTING_ID = CSR.WT_ACCOUNT_SETTING_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = WTAS.ACCOUNT_COMBINATION_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN ACCOUNT_TYPE AT ON AT.ACCOUNT_TYPE_ID = A.ACCOUNT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND CSR.CASH_SALE_TYPE_ID = 1 \
    AND CSR.WT_ACCOUNT_SETTING_ID IS NOT NULL \
	AND AC.COMPANY_ID = IN_COMPANY_ID
CashSaleReturn1.sql.bs=AND CSR.DATE <= IN_AS_OF_DATE \
	AND FW.IS_COMPLETE = 1
CashSaleReturn1.sql.is=AND CSR.DATE BETWEEN IN_DATE_FROM AND IN_DATE_TO \
	AND FW.IS_COMPLETE = 1
CashSaleReturn1.sql.inv.entries=1;2
CashSaleReturn1.sql.1.inv=SELECT 'CASH SALE RETURN' AS SOURCE, CSRI.WAREHOUSE_ID AS WAREHOUSE_ID, CSRI.ITEM_ID AS ITEM_ID, I.STOCK_CODE AS STOCK_CODE, \
	I.DESCRIPTION AS DESCRIPTION, I.ITEM_CATEGORY_ID AS ITEM_CATEGORY_ID, I.UNIT_MEASUREMENT_ID as UNIT_MEASUREMENT_ID, ABS(CSRI.QUANTITY) AS IN_QUANTITY, 0 AS OUT_QUANTITY, \
	CSRI.UNIT_COST AS IN_UNIT_COST, 0 AS OUT_UNIT_COST, ABS(CSRI.UNIT_COST * CSRI.QUANTITY) AS IN_TOTAL_COST, 0 AS OUT_TOTAL_QUANTITY, \
	CSR.DATE AS DATE, CSR.CREATED_DATE, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, I.ACTIVE, \
	CONCAT('CSR', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CS.SALE_INVOICE_NO AS INVOICE_NUMBER, ARC.NAME AS TRANSACTION_DESCRIPTION, CSRI.SRP AS SRP, \
	CSR.EB_OBJECT_ID as PARENT_EB_OBJECT_ID, CSRI.EB_OBJECT_ID as EB_OBJECT_ID  \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_CUSTOMER ARC ON ARC.AR_CUSTOMER_ID = CSR.AR_CUSTOMER_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	INNER JOIN ITEM I ON CSRI.ITEM_ID = I.ITEM_ID \
	WHERE CSRI.QUANTITY < 0 \
	AND CSR.CASH_SALE_TYPE_ID=1 \
	AND CSR.COMPANY_ID = IN_COMPANY_ID
CashSaleReturn1.sql.2.inv=SELECT 'CASH SALE RETURN' AS SOURCE, CSRI.WAREHOUSE_ID AS WAREHOUSE_ID, CSRI.ITEM_ID AS ITEM_ID, I.STOCK_CODE AS STOCK_CODE, \
	I.DESCRIPTION AS DESCRIPTION, I.ITEM_CATEGORY_ID AS ITEM_CATEGORY_ID, I.UNIT_MEASUREMENT_ID as UNIT_MEASUREMENT_ID, 0 AS IN_QUANTITY, CSRI.QUANTITY AS OUT_QUANTITY, \
	0 AS IN_UNIT_COST, CSRI.UNIT_COST AS OUT_UNIT_COST, 0 AS IN_TOTAL_COST, CSRI.UNIT_COST * CSRI.QUANTITY AS OUT_TOTAL_QUANTITY, \
	CSR.DATE AS DATE, CSR.CREATED_DATE, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, I.ACTIVE, \
	CONCAT('CSR', CSR.CSR_NUMBER) as REFERENCE_NUMBER, \
	CS.SALE_INVOICE_NO AS INVOICE_NUMBER, ARC.NAME AS TRANSACTION_DESCRIPTION, CSRI.SRP AS SRP, \
	CSR.EB_OBJECT_ID as PARENT_EB_OBJECT_ID, CSRI.EB_OBJECT_ID as EB_OBJECT_ID  \
	FROM CASH_SALE_RETURN_ITEM CSRI \
	INNER JOIN CASH_SALE_RETURN CSR ON CSR.CASH_SALE_RETURN_ID = CSRI.CASH_SALE_RETURN_ID \
	INNER JOIN CASH_SALE CS ON CS.CASH_SALE_ID = CSR.CASH_SALE_ID \
	INNER JOIN AR_CUSTOMER ARC ON ARC.AR_CUSTOMER_ID = CSR.AR_CUSTOMER_ID \
	INNER JOIN FORM_WORKFLOW FW ON CSR.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	INNER JOIN ITEM I ON CSRI.ITEM_ID = I.ITEM_ID \
	WHERE CSRI.QUANTITY >= 0 \
	AND CSR.CASH_SALE_TYPE_ID=1 \
	AND CSR.COMPANY_ID = IN_COMPANY_ID
CashSaleReturn1.sql.inv.as=AND FW.IS_COMPLETE = 1 \
	AND CSRI.ITEM_ID = IN_ITEM_ID \
	AND CSRI.WAREHOUSE_ID = IN_WAREHOUSE_ID \
	AND CSR.DATE <= IN_DATE
CashSaleReturn1.sql.inv.rsf=AND FW.IS_COMPLETE = 1 \
	AND CSRI.ITEM_ID = IN_ITEM_ID \
	AND CSRI.WAREHOUSE_ID = IN_WAREHOUSE_ID \
	AND CSR.DATE > IN_DATE
CashSaleReturn1.sql.inv.il=AND CSR.DATE <= IN_DATE \
	AND IF(IN_ITEM_CATEGORY_ID != -1, I.ITEM_CATEGORY_ID = IN_ITEM_CATEGORY_ID, I.ITEM_CATEGORY_ID != 0) \
	AND IF(IN_WAREHOUSE_ID != -1, CSRI.WAREHOUSE_ID = IN_WAREHOUSE_ID, CSRI.WAREHOUSE_ID != IN_WAREHOUSE_ID) \
	AND IF(IN_IS_ACTIVE != -1, I.ACTIVE = IN_IS_ACTIVE, I.ACTIVE != IN_IS_ACTIVE ) \
	AND CASE WHEN IN_STATUS = -1 THEN FW.CURRENT_STATUS_ID != 4 \
		WHEN IN_STATUS = 1 THEN FW.IS_COMPLETE = 1 END
CashSaleReturn1.sql.inv.sc=AND FW.IS_COMPLETE = 1 \
	AND CSRI.ITEM_ID = IN_ITEM_ID \
	AND CSR.DATE BETWEEN IN_START_DATE AND IN_END_DATE \
	AND CSRI.WAREHOUSE_ID = IN_WAREHOUSE_ID
CashSaleReturn1.sql.inv.ft=AND FW.IS_COMPLETE = 1 \
	AND CSRI.ITEM_ID = IN_ITEM_ID \
	AND CSRI.WAREHOUSE_ID = IN_WAREHOUSE_ID \
	AND CSR.DATE > IN_AS_OF_DATE