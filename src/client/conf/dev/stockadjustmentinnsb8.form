
# Description: Stock Adjustment - IN - NSB 8 workflow and journal entries configuration.

StockAdjustment9.typeId=9
StockAdjustment9.form=nsbStockAdjustment/1/viewForm
StockAdjustment9.edit=stock_adjustment_in_nsb8_edit
StockAdjustment9.print=nsbStockAdjustmentPDF/1
StockAdjustment9.service=eulap.eb.service.NSBStockAdjustmentService
StockAdjustment9.oo.parent_to_child=1
StockAdjustment9.oo.child_to_child=3
StockAdjustment9.flow=1;2
StockAdjustment9.1.statusId=1
StockAdjustment9.1.required=
StockAdjustment9.1.next=2
StockAdjustment9.1.product_code=24106
StockAdjustment9.1.module_code=8
StockAdjustment9.2.statusId=3
StockAdjustment9.2.required=1
StockAdjustment9.2.next=0
StockAdjustment9.2.product_code=24106
StockAdjustment9.2.module_code=16
StockAdjustment9.sql.entries=1;2;3;4
# Stock Adjustment IN - Inventory Account - Debit
StockAdjustment9.sql.1.je=SELECT 'STOCK ADJUSTMENT - IN - NSB 8' as SOURCE, SA.STOCK_ADJUSTMENT_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, \
	D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, SA.SA_DATE as GL_DATE, \
	CONCAT('SAI ', SA.SA_NUMBER) as REFERENCE_NUMBER, SA.REMARKS AS DESCRIPTION, SAI.AMOUNT as DEBIT, 0 as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, \
	COALESCE((SELECT TRIM(GROUP_CONCAT(DISTINCT ' ', SAI1.PO_NUMBER)) FROM STOCK_ADJUSTMENT_ITEM SAI1 \
	INNER JOIN STOCK_ADJUSTMENT SA1 ON SA1.STOCK_ADJUSTMENT_ID = SAI1.STOCK_ADJUSTMENT_ID \
	WHERE SA1.STOCK_ADJUSTMENT_ID = SA.STOCK_ADJUSTMENT_ID), '') AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM STOCK_ADJUSTMENT_ITEM SAI \
	INNER JOIN STOCK_ADJUSTMENT SA ON SA.STOCK_ADJUSTMENT_ID = SAI.STOCK_ADJUSTMENT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = SAI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.INVENTORY_ACCOUNT AND AC.COMPANY_ID = SA.COMPANY_ID) \
	INNER JOIN ACCOUNT_COMBINATION ACC ON \
	(ACC.ACCOUNT_COMBINATION_ID = ICAS.COST_ACCOUNT AND ACC.COMPANY_ID = SA.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON SA.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND SA.DIVISION_ID = ACC.DIVISION_ID \
	AND QUANTITY > 0 \
	AND SA.STOCK_ADJUSTMENT_CLASSIFICATION_ID = 9 \
	AND SA.DIVISION_ID = 5 \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Stock Adjustment IN - Adjustment Type - Credit
StockAdjustment9.sql.2.je=SELECT 'STOCK ADJUSTMENT - IN - NSB 8' as SOURCE, SA.STOCK_ADJUSTMENT_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, \
	D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, SA.SA_DATE as GL_DATE, \
	CONCAT('SAI ', SA.SA_NUMBER) as REFERENCE_NUMBER, SA.REMARKS AS DESCRIPTION, 0 as DEBIT, SAI.AMOUNT as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, \
	COALESCE((SELECT TRIM(GROUP_CONCAT(DISTINCT ' ', SAI1.PO_NUMBER)) FROM STOCK_ADJUSTMENT_ITEM SAI1 \
	INNER JOIN STOCK_ADJUSTMENT SA1 ON SA1.STOCK_ADJUSTMENT_ID = SAI1.STOCK_ADJUSTMENT_ID \
	WHERE SA1.STOCK_ADJUSTMENT_ID = SA.STOCK_ADJUSTMENT_ID), '') AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM STOCK_ADJUSTMENT_ITEM SAI \
	INNER JOIN STOCK_ADJUSTMENT SA ON SA.STOCK_ADJUSTMENT_ID = SAI.STOCK_ADJUSTMENT_ID \
	INNER JOIN STOCK_ADJUSTMENT_TYPE SAT ON SAT.STOCK_ADJUSTMENT_TYPE_ID = SA.STOCK_ADJUSTMENT_TYPE_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = SAT.ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = SA.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON SA.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE QUANTITY > 0 \
	AND SA.STOCK_ADJUSTMENT_CLASSIFICATION_ID = 9 \
	AND SA.DIVISION_ID = 5 \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Stock Adjustment IN - Inventory Account - Serial Item - Debit
StockAdjustment9.sql.3.je=SELECT 'STOCK ADJUSTMENT - IN - NSB 8' as SOURCE, SA.STOCK_ADJUSTMENT_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, \
	D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, SA.SA_DATE as GL_DATE, \
	CONCAT('SAI ', SA.SA_NUMBER) as REFERENCE_NUMBER, SA.REMARKS AS DESCRIPTION, SAI.AMOUNT as DEBIT, 0 as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, \
	COALESCE((SELECT TRIM(GROUP_CONCAT(DISTINCT ' ', SAI1.PO_NUMBER)) FROM STOCK_ADJUSTMENT_ITEM SAI1 \
	INNER JOIN STOCK_ADJUSTMENT SA1 ON SA1.STOCK_ADJUSTMENT_ID = SAI1.STOCK_ADJUSTMENT_ID \
	WHERE SA1.STOCK_ADJUSTMENT_ID = SA.STOCK_ADJUSTMENT_ID), '') AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM SERIAL_ITEM SAI \
	INNER JOIN OBJECT_TO_OBJECT OTO ON OTO.TO_OBJECT_ID = SAI.EB_OBJECT_ID \
	INNER JOIN STOCK_ADJUSTMENT SA ON SA.EB_OBJECT_ID = OTO.FROM_OBJECT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = SAI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.INVENTORY_ACCOUNT AND AC.COMPANY_ID = SA.COMPANY_ID) \
	INNER JOIN ACCOUNT_COMBINATION ACC ON \
	(ACC.ACCOUNT_COMBINATION_ID = ICAS.COST_ACCOUNT AND ACC.COMPANY_ID = SA.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON SA.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND SA.DIVISION_ID = ACC.DIVISION_ID \
	AND OTO.OR_TYPE_ID = 56 \
	AND SAI.EB_OBJECT_ID IS NOT NULL \
	AND SA.STOCK_ADJUSTMENT_CLASSIFICATION_ID = 9 \
	AND SA.DIVISION_ID = 5 \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND SAI.ACTIVE = 1 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Stock Adjustment IN - Adjustment Type - Serial Item - Credit
StockAdjustment9.sql.4.je=SELECT 'STOCK ADJUSTMENT - IN - NSB 8' as SOURCE, SA.STOCK_ADJUSTMENT_ID as ID, AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, \
	D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER as ACCT_NO, A.ACCOUNT_NAME, SA.SA_DATE as GL_DATE, \
	CONCAT('SAI ', SA.SA_NUMBER) as REFERENCE_NUMBER, SA.REMARKS AS DESCRIPTION, 0 as DEBIT, SAI.AMOUNT as CREDIT, \
	FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE as IS_POSTED, \
	COALESCE((SELECT TRIM(GROUP_CONCAT(DISTINCT ' ', SAI1.PO_NUMBER)) FROM STOCK_ADJUSTMENT_ITEM SAI1 \
	INNER JOIN STOCK_ADJUSTMENT SA1 ON SA1.STOCK_ADJUSTMENT_ID = SAI1.STOCK_ADJUSTMENT_ID \
	WHERE SA1.STOCK_ADJUSTMENT_ID = SA.STOCK_ADJUSTMENT_ID), '') AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM SERIAL_ITEM SAI \
	INNER JOIN OBJECT_TO_OBJECT OTO ON OTO.TO_OBJECT_ID = SAI.EB_OBJECT_ID \
	INNER JOIN STOCK_ADJUSTMENT SA ON SA.EB_OBJECT_ID = OTO.FROM_OBJECT_ID \
	INNER JOIN STOCK_ADJUSTMENT_TYPE SAT ON SAT.STOCK_ADJUSTMENT_TYPE_ID = SA.STOCK_ADJUSTMENT_TYPE_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = SAT.ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = SA.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON SA.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE OTO.OR_TYPE_ID = 56 \
	AND SAI.EB_OBJECT_ID IS NOT NULL \
	AND SA.STOCK_ADJUSTMENT_CLASSIFICATION_ID = 9 \
	AND SA.DIVISION_ID = 5 \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND SAI.ACTIVE = 1 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
StockAdjustment9.sql.je.jerr=AND SA.SA_DATE BETWEEN DATE_FROM AND DATE_TO \
	AND (CASE WHEN IN_REFERENCE_NUMBER NOT LIKE '-1' THEN CONCAT('SAI ', SA_NUMBER) LIKE IN_REFERENCE_NUMBER \
		ELSE IN_REFERENCE_NUMBER LIKE IN_REFERENCE_NUMBER END) \
	AND (CASE IN_SOURCE WHEN 'STOCK ADJUSTMENT - IN - NSB 8' THEN SA.STOCK_ADJUSTMENT_ID != 0 \
		WHEN 'ALL' THEN SA.STOCK_ADJUSTMENT_ID != 0 \
		ELSE SA.STOCK_ADJUSTMENT_ID = 0 END) \
	AND (CASE WHEN IN_IS_POSTED != -1 THEN FW.IS_COMPLETE = IN_IS_POSTED ELSE FW.IS_COMPLETE != IN_IS_POSTED END)
StockAdjustment9.sql.je.ab=AND IF(DATE_FROM IS NOT NULL, SA.SA_DATE BETWEEN DATE_FROM AND DATE_TO, SA.SA_DATE <= DATE_TO) \
	AND IF(IN_DIVISION_ID != -1, SA.DIVISION_ID = IN_DIVISION_ID, SA.DIVISION_ID != IN_DIVISION_ID) \
	AND FW.IS_COMPLETE = 1
StockAdjustment9.sql.je.aa=AND D.NUMBER BETWEEN IN_FROM_DIVISION AND IN_TO_DIVISION \
	AND AC.ACCOUNT_ID = IN_ACCOUNT_ID \
	AND SA.SA_DATE BETWEEN DATE_FROM AND DATE_TO \
	AND SA.REMARKS LIKE IN_DESCRIPTION \
	AND FW.IS_COMPLETE = 1
# Configuration for IS and BS by division
StockAdjustment9.sql.1.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	SAI.AMOUNT as DEBIT, 0 as CREDIT, A.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, SA.SA_DATE AS DATE \
	FROM STOCK_ADJUSTMENT_ITEM SAI \
	INNER JOIN STOCK_ADJUSTMENT SA ON SA.STOCK_ADJUSTMENT_ID = SAI.STOCK_ADJUSTMENT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = SAI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.INVENTORY_ACCOUNT AND AC.COMPANY_ID = SA.COMPANY_ID) \
	INNER JOIN ACCOUNT_COMBINATION ACC ON \
	(ACC.ACCOUNT_COMBINATION_ID = ICAS.COST_ACCOUNT AND ACC.COMPANY_ID = SA.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON SA.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND SA.DIVISION_ID = ACC.DIVISION_ID \
	AND QUANTITY > 0 \
	AND SA.STOCK_ADJUSTMENT_CLASSIFICATION_ID = 9 \
	AND SA.DIVISION_ID = 5 \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Stock Adjustment IN - Adjustment Type - Credit
StockAdjustment9.sql.2.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 as DEBIT, SAI.AMOUNT as CREDIT, A.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, SA.SA_DATE AS DATE \
	FROM STOCK_ADJUSTMENT_ITEM SAI \
	INNER JOIN STOCK_ADJUSTMENT SA ON SA.STOCK_ADJUSTMENT_ID = SAI.STOCK_ADJUSTMENT_ID \
	INNER JOIN STOCK_ADJUSTMENT_TYPE SAT ON SAT.STOCK_ADJUSTMENT_TYPE_ID = SA.STOCK_ADJUSTMENT_TYPE_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = SAT.ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = SA.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON SA.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE QUANTITY > 0 \
	AND SA.STOCK_ADJUSTMENT_CLASSIFICATION_ID = 9 \
	AND SA.DIVISION_ID = 5 \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Configuration for IS and BS by division
StockAdjustment9.sql.3.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	SAI.AMOUNT as DEBIT, 0 as CREDIT, A.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, SA.SA_DATE AS DATE \
	FROM SERIAL_ITEM SAI \
	INNER JOIN OBJECT_TO_OBJECT OTO ON OTO.TO_OBJECT_ID = SAI.EB_OBJECT_ID \
	INNER JOIN STOCK_ADJUSTMENT SA ON SA.EB_OBJECT_ID = OTO.FROM_OBJECT_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = SAI.ITEM_ID \
	INNER JOIN ITEM_CATEGORY_ACCOUNT_SETUP ICAS ON I.ITEM_CATEGORY_ID = ICAS.ITEM_CATEGORY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = ICAS.INVENTORY_ACCOUNT AND AC.COMPANY_ID = SA.COMPANY_ID) \
	INNER JOIN ACCOUNT_COMBINATION ACC ON \
	(ACC.ACCOUNT_COMBINATION_ID = ICAS.COST_ACCOUNT AND ACC.COMPANY_ID = SA.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON SA.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE ICAS.COMPANY_ID = AC.COMPANY_ID \
	AND SA.DIVISION_ID = ACC.DIVISION_ID \
	AND OTO.OR_TYPE_ID = 56 \
	AND SAI.EB_OBJECT_ID IS NOT NULL \
	AND SA.STOCK_ADJUSTMENT_CLASSIFICATION_ID = 9 \
	AND SA.DIVISION_ID = 5 \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND SAI.ACTIVE = 1 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
# Stock Adjustment IN - Adjustment Type - Credit
StockAdjustment9.sql.4.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 as DEBIT, SAI.AMOUNT as CREDIT, A.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, SA.SA_DATE AS DATE \
	FROM SERIAL_ITEM SAI \
	INNER JOIN OBJECT_TO_OBJECT OTO ON OTO.TO_OBJECT_ID = SAI.EB_OBJECT_ID \
	INNER JOIN STOCK_ADJUSTMENT SA ON SA.EB_OBJECT_ID = OTO.FROM_OBJECT_ID \
	INNER JOIN STOCK_ADJUSTMENT_TYPE SAT ON SAT.STOCK_ADJUSTMENT_TYPE_ID = SA.STOCK_ADJUSTMENT_TYPE_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON \
	(AC.ACCOUNT_COMBINATION_ID = SAT.ACCOUNT_COMBINATION_ID AND AC.COMPANY_ID = SA.COMPANY_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON SA.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	WHERE OTO.OR_TYPE_ID = 56 \
	AND SAI.EB_OBJECT_ID IS NOT NULL \
	AND SA.STOCK_ADJUSTMENT_CLASSIFICATION_ID = 9 \
	AND SA.DIVISION_ID = 5 \
	AND FW.CURRENT_STATUS_ID != 4 \
	AND SAI.ACTIVE = 1 \
	AND AC.COMPANY_ID = IN_COMPANY_ID
StockAdjustment9.sql.bs=AND SA.SA_DATE <= IN_AS_OF_DATE \
	AND FW.IS_COMPLETE = 1
StockAdjustment9.sql.is=AND SA.SA_DATE BETWEEN IN_DATE_FROM AND IN_DATE_TO \
	AND FW.IS_COMPLETE = 1
StockAdjustment9.sql.inv.entries=1;2
StockAdjustment9.sql.1.inv=SELECT 'STOCK ADJUSTMENT - IN - NSB 8' AS SOURCE, SA.WAREHOUSE_ID AS WAREHOUSE_ID, SAI.ITEM_ID AS ITEM_ID, I.STOCK_CODE AS STOCK_CODE, \
	I.DESCRIPTION AS DESCRIPTION, I.ITEM_CATEGORY_ID AS ITEM_CATEGORY_ID, I.UNIT_MEASUREMENT_ID as UNIT_MEASUREMENT_ID, ABS(SAI.QUANTITY) AS IN_QUANTITY, 0 AS OUT_QUANTITY, \
	SAI.UNIT_COST AS IN_UNIT_COST, 0 AS OUT_UNIT_COST, (SAI.UNIT_COST * ABS(SAI.QUANTITY)) AS IN_TOTAL_COST, 0 AS OUT_TOTAL_COST, \
	SA.SA_DATE AS DATE, SA.CREATED_DATE, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, I.ACTIVE, CONCAT('SA ', SA.SA_NUMBER) AS REFERENCE_NUMBER, \
	'' AS INVOICE_NUMBER , CONCAT('SA - ', SAT.NAME) AS TRANS_DESCRIPTION, 0.0 AS SRP, SA.EB_OBJECT_ID as PARENT_EB_OBJECT_ID, SAI.EB_OBJECT_ID as EB_OBJECT_ID, \
	D.NAME AS DIVISION_NAME, SA.BMS_NUMBER, D.DIVISION_ID, COALESCE(ISP.SRP, 0) AS LATEST_SRP, UM.NAME AS UOM_NAME \
	FROM STOCK_ADJUSTMENT_ITEM SAI \
	INNER JOIN STOCK_ADJUSTMENT SA ON SAI.STOCK_ADJUSTMENT_ID = SA.STOCK_ADJUSTMENT_ID \
	INNER JOIN STOCK_ADJUSTMENT_TYPE SAT ON SA.STOCK_ADJUSTMENT_TYPE_ID  = SAT.STOCK_ADJUSTMENT_TYPE_ID \
	INNER JOIN DIVISION D ON SA.DIVISION_ID = D.DIVISION_ID \
	INNER JOIN FORM_WORKFLOW FW ON SA.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	INNER JOIN ITEM I ON SAI.ITEM_ID = I.ITEM_ID \
	LEFT JOIN ITEM_SRP ISP ON ISP.ITEM_ID = I.ITEM_ID AND ISP.ACTIVE = 1 \
	INNER JOIN UNIT_MEASUREMENT UM ON UM.UNITOFMEASUREMENT_ID = I.UNIT_MEASUREMENT_ID \
	WHERE SAI.QUANTITY >= 0 \
	AND SA.STOCK_ADJUSTMENT_CLASSIFICATION_ID = 9 \
	AND SA.DIVISION_ID = 5 \
	AND SAI.UNIT_COST IS NOT NULL \
	AND SA.COMPANY_ID = IN_COMPANY_ID
StockAdjustment9.sql.2.inv=SELECT 'STOCK ADJUSTMENT - IN - NSB 8' AS SOURCE, SA.WAREHOUSE_ID AS WAREHOUSE_ID, SAI.ITEM_ID AS ITEM_ID, I.STOCK_CODE AS STOCK_CODE, \
	I.DESCRIPTION AS DESCRIPTION, I.ITEM_CATEGORY_ID AS ITEM_CATEGORY_ID, I.UNIT_MEASUREMENT_ID as UNIT_MEASUREMENT_ID, ABS(SAI.QUANTITY) AS IN_QUANTITY, 0 AS OUT_QUANTITY, \
	SAI.UNIT_COST AS IN_UNIT_COST, 0 AS OUT_UNIT_COST, (SAI.UNIT_COST * ABS(SAI.QUANTITY)) AS IN_TOTAL_COST, 0 AS OUT_TOTAL_COST, \
	SA.SA_DATE AS DATE, SA.CREATED_DATE, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, I.ACTIVE, CONCAT('SA ', SA.SA_NUMBER) AS REFERENCE_NUMBER, \
	'' AS INVOICE_NUMBER , CONCAT('SA - ', SAT.NAME) AS TRANS_DESCRIPTION, 0.0 AS SRP, SA.EB_OBJECT_ID as PARENT_EB_OBJECT_ID, SAI.EB_OBJECT_ID as EB_OBJECT_ID, \
	D.NAME AS DIVISION_NAME, SA.BMS_NUMBER, D.DIVISION_ID, COALESCE(ISP.SRP, 0) AS LATEST_SRP, UM.NAME AS UOM_NAME \
	FROM SERIAL_ITEM SAI \
	INNER JOIN OBJECT_TO_OBJECT OTO ON OTO.TO_OBJECT_ID = SAI.EB_OBJECT_ID \
	INNER JOIN STOCK_ADJUSTMENT SA ON SA.EB_OBJECT_ID = OTO.FROM_OBJECT_ID \
	INNER JOIN DIVISION D ON SA.DIVISION_ID = D.DIVISION_ID \
	INNER JOIN STOCK_ADJUSTMENT_TYPE SAT ON SA.STOCK_ADJUSTMENT_TYPE_ID  = SAT.STOCK_ADJUSTMENT_TYPE_ID \
	INNER JOIN FORM_WORKFLOW FW ON SA.FORM_WORKFLOW_ID = FW.FORM_WORKFLOW_ID \
	INNER JOIN ITEM I ON I.ITEM_ID = SAI.ITEM_ID \
	LEFT JOIN ITEM_SRP ISP ON ISP.ITEM_ID = I.ITEM_ID AND ISP.ACTIVE = 1 \
	INNER JOIN UNIT_MEASUREMENT UM ON UM.UNITOFMEASUREMENT_ID = I.UNIT_MEASUREMENT_ID \
	WHERE SAI.ACTIVE = 1 \
	AND OTO.OR_TYPE_ID = 56 \
	AND SAI.UNIT_COST IS NOT NULL \
	AND SAI.EB_OBJECT_ID IS NOT NULL \
	AND SA.STOCK_ADJUSTMENT_CLASSIFICATION_ID = 9 \
	AND SA.DIVISION_ID = 5 \
	AND SA.COMPANY_ID = IN_COMPANY_ID
StockAdjustment9.sql.inv.as=AND FW.IS_COMPLETE = 1 \
	AND SAI.ITEM_ID = IN_ITEM_ID \
	AND SA.WAREHOUSE_ID = IN_WAREHOUSE_ID \
	AND SA.SA_DATE <= IN_DATE
StockAdjustment9.sql.inv.rsf=AND FW.IS_COMPLETE = 1 \
	AND SAI.ITEM_ID = IN_ITEM_ID \
	AND SA.WAREHOUSE_ID = IN_WAREHOUSE_ID \
	AND SA.SA_DATE > IN_DATE
StockAdjustment9.sql.inv.il=AND SA.SA_DATE <= IN_DATE \
	AND IF(IN_ITEM_CATEGORY_ID != -1, I.ITEM_CATEGORY_ID = IN_ITEM_CATEGORY_ID, I.ITEM_CATEGORY_ID != 0) \
	AND IF(IN_WAREHOUSE_ID != -1, SA.WAREHOUSE_ID = IN_WAREHOUSE_ID, SA.WAREHOUSE_ID != IN_WAREHOUSE_ID) \
	AND IF(IN_DIVISION_ID != -1, SA.DIVISION_ID = IN_DIVISION_ID, SA.DIVISION_ID != IN_DIVISION_ID) \
	AND IF(IN_IS_ACTIVE != -1, I.ACTIVE = IN_IS_ACTIVE, I.ACTIVE != IN_IS_ACTIVE ) \
	AND CASE WHEN IN_STATUS = -1 THEN FW.CURRENT_STATUS_ID != 4 WHEN IN_STATUS = 1 THEN FW.IS_COMPLETE = 1 END
StockAdjustment9.sql.inv.sc=AND FW.IS_COMPLETE = 1 \
	AND SAI.ITEM_ID = IN_ITEM_ID \
	AND SA.SA_DATE BETWEEN IN_START_DATE AND IN_END_DATE \
	AND SA.WAREHOUSE_ID = IN_WAREHOUSE_ID \
	AND SA.DIVISION_ID = IN_DIVISION_ID
StockAdjustment9.sql.inv.ft=AND FW.IS_COMPLETE = 1 \
	AND SAI.ITEM_ID = IN_ITEM_ID \
	AND SA.WAREHOUSE_ID = IN_WAREHOUSE_ID \
	AND SA.SA_DATE > IN_AS_OF_DATE