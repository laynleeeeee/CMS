
# Description	: Purchase order - NSB 3 form workflow and journal entries configuration

SupplierAdvancePayment2.typeId=1
SupplierAdvancePayment2.form=supplierAdvPayment/viewForm
SupplierAdvancePayment2.edit=supplier_adv_payment_nsb3_edit
SupplierAdvancePayment2.print=supplierAdvPayment/pdf
SupplierAdvancePayment2.service=eulap.eb.service.SupplierAdvPaymentService
SupplierAdvancePayment2.oo.parent_to_child=1
SupplierAdvancePayment2.oo.child_to_child=24000
SupplierAdvancePayment2.flow=1;2
SupplierAdvancePayment2.1.statusId=1
SupplierAdvancePayment2.1.required=
SupplierAdvancePayment2.1.next=2
SupplierAdvancePayment2.1.product_code=24017
SupplierAdvancePayment2.1.module_code=3
SupplierAdvancePayment2.2.statusId=30
SupplierAdvancePayment2.2.required=1
SupplierAdvancePayment2.2.next=0
SupplierAdvancePayment2.2.product_code=24017
SupplierAdvancePayment2.2.module_code=16
SupplierAdvancePayment2.sql.entries=1;2
SupplierAdvancePayment2.sql.1.je=SELECT 'SUPPLIER ADVANCE PAYMENT - NSB 3' AS SOURCE, SAP.SUPPLIER_ADVANCE_PAYMENT_ID AS ID, \
	AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER AS ACCT_NO, \
	A.ACCOUNT_NAME, SAP.GL_DATE AS GL_DATE, CONCAT('SAP ', SAP.SEQUENCE_NO) AS REFERENCE_NUMBER, SAP.REMARKS AS DESCRIPTION, \
	SAP.AMOUNT AS DEBIT, 0 AS CREDIT, FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE AS IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM SUPPLIER_ADVANCE_PAYMENT SAP \
    INNER JOIN SUPPLIER_ADV_PAYMENT_ACCOUNT SAPA ON SAPA.COMPANY_ID = SAP.COMPANY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON (AC.ACCOUNT_COMBINATION_ID = SAPA.ACCOUNT_COMBINATION_ID \
		AND AC.COMPANY_ID = SAP.COMPANY_ID AND AC.DIVISION_ID = SAP.DIVISION_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON FW.FORM_WORKFLOW_ID = SAP.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND SAP.DIVISION_ID = 2 \
	AND SAP.COMPANY_ID = IN_COMPANY_ID
SupplierAdvancePayment2.sql.2.je=SELECT 'SUPPLIER ADVANCE PAYMENT - NSB 3' AS SOURCE, SAP.SUPPLIER_ADVANCE_PAYMENT_ID AS ID, \
	AC.COMPANY_ID, AC.DIVISION_ID, AC.ACCOUNT_ID, D.NUMBER AS DIVISION_NO, D.NAME AS DIVISION_NAME, A.NUMBER AS ACCT_NO, \
	A.ACCOUNT_NAME, SAP.GL_DATE AS GL_DATE, CONCAT('SAP ', SAP.SEQUENCE_NO) AS REFERENCE_NUMBER, SAP.REMARKS AS DESCRIPTION, \
	0 AS DEBIT, SAP.AMOUNT AS CREDIT, FW.FORM_WORKFLOW_ID, FW.CURRENT_STATUS_ID, FW.IS_COMPLETE, FW.IS_COMPLETE AS IS_POSTED, '' AS CUSTOMER_PO_NO, A.ACCOUNT_TYPE_ID \
	FROM SUPPLIER_ADVANCE_PAYMENT SAP \
	INNER JOIN SUPPLIER_ACCOUNT SA ON SA.SUPPLIER_ACCOUNT_ID = SAP.SUPPLIER_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = SA.DEFAULT_CREDIT_AC_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON FW.FORM_WORKFLOW_ID = SAP.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND SAP.DIVISION_ID = 2 \
	AND SAP.COMPANY_ID = IN_COMPANY_ID
SupplierAdvancePayment2.sql.je.jerr=AND SAP.GL_DATE BETWEEN DATE_FROM AND DATE_TO \
	AND (CASE WHEN IN_REFERENCE_NUMBER NOT LIKE '-1' THEN CONCAT('SAP ', SAP.SEQUENCE_NO) LIKE IN_REFERENCE_NUMBER \
		ELSE IN_REFERENCE_NUMBER LIKE IN_REFERENCE_NUMBER END) \
	AND (CASE IN_SOURCE WHEN 'SUPPLIER ADVANCE PAYMENT - NSB 3' THEN SAP.SUPPLIER_ADVANCE_PAYMENT_ID != 0 \
		WHEN 'ALL' THEN SAP.SUPPLIER_ADVANCE_PAYMENT_ID != 0 ELSE SAP.SUPPLIER_ADVANCE_PAYMENT_ID = 0 END) \
	AND (CASE WHEN IN_IS_POSTED != -1 THEN FW.IS_COMPLETE = IN_IS_POSTED ELSE FW.IS_COMPLETE != IN_IS_POSTED END)
SupplierAdvancePayment2.sql.je.ab=AND IF(DATE_FROM IS NOT NULL, SAP.GL_DATE BETWEEN DATE_FROM AND DATE_TO, SAP.GL_DATE <= DATE_TO) \
	AND IF(IN_DIVISION_ID != -1, SAP.DIVISION_ID = IN_DIVISION_ID, SAP.DIVISION_ID != IN_DIVISION_ID) \
	AND FW.IS_COMPLETE = 1
SupplierAdvancePayment2.sql.je.aa=AND D.NUMBER BETWEEN IN_FROM_DIVISION AND IN_TO_DIVISION \
	AND AC.ACCOUNT_ID = IN_ACCOUNT_ID \
	AND SAP.GL_DATE BETWEEN DATE_FROM AND DATE_TO \
	AND SAP.REMARKS LIKE IN_DESCRIPTION \
	AND FW.IS_COMPLETE = 1
SupplierAdvancePayment2.sql.je.gll=AND AC.ACCOUNT_ID = IN_ACCOUNT_ID \
	AND SAP.GL_DATE BETWEEN DATE_FROM AND DATE_TO \
	AND FW.IS_COMPLETE = 1
# Configuration for IS and BS by division
SupplierAdvancePayment2.sql.1.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	SAP.AMOUNT AS DEBIT, 0 AS CREDIT, A.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, SAP.GL_DATE AS DATE \
	FROM SUPPLIER_ADVANCE_PAYMENT SAP \
    INNER JOIN SUPPLIER_ADV_PAYMENT_ACCOUNT SAPA ON SAPA.COMPANY_ID = SAP.COMPANY_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON (AC.ACCOUNT_COMBINATION_ID = SAPA.ACCOUNT_COMBINATION_ID \
		AND AC.COMPANY_ID = SAP.COMPANY_ID AND AC.DIVISION_ID = SAP.DIVISION_ID) \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON FW.FORM_WORKFLOW_ID = SAP.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND SAP.DIVISION_ID = 2 \
	AND SAP.COMPANY_ID = IN_COMPANY_ID
SupplierAdvancePayment2.sql.2.isbs=SELECT AC.COMPANY_ID, D.NAME AS DIVISION_NAME, D.DIVISION_ID, A.ACCOUNT_NAME, A.ACCOUNT_ID, A.PARENT_ACCOUNT_ID, \
	0 AS DEBIT, SAP.AMOUNT AS CREDIT, A.ACCOUNT_TYPE_ID, A.NUMBER as ACCT_NO, SAP.GL_DATE AS DATE \
	FROM SUPPLIER_ADVANCE_PAYMENT SAP \
	INNER JOIN SUPPLIER_ACCOUNT SA ON SA.SUPPLIER_ACCOUNT_ID = SAP.SUPPLIER_ACCOUNT_ID \
	INNER JOIN ACCOUNT_COMBINATION AC ON AC.ACCOUNT_COMBINATION_ID = SA.DEFAULT_CREDIT_AC_ID \
	INNER JOIN DIVISION D ON D.DIVISION_ID = AC.DIVISION_ID \
	INNER JOIN ACCOUNT A ON A.ACCOUNT_ID = AC.ACCOUNT_ID \
	INNER JOIN FORM_WORKFLOW FW ON FW.FORM_WORKFLOW_ID = SAP.FORM_WORKFLOW_ID \
	WHERE FW.CURRENT_STATUS_ID != 4 \
	AND SAP.DIVISION_ID = 2 \
	AND SAP.COMPANY_ID = IN_COMPANY_ID
SupplierAdvancePayment2.sql.bs=AND SAP.GL_DATE <= IN_AS_OF_DATE \
	AND FW.IS_COMPLETE = 1
SupplierAdvancePayment2.sql.is=AND SAP.GL_DATE BETWEEN IN_DATE_FROM AND IN_DATE_TO \
	AND FW.IS_COMPLETE = 1